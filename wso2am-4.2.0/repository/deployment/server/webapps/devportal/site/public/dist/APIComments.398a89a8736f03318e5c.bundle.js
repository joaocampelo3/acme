(this.webpackJsonp=this.webpackJsonp||[]).push([[22],{2126:function(e,t,n){"use strict";var a=n(1214),i=n(1216);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(2)),s=(0,a(n(1217)).default)(o.createElement("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"AddCircleOutline");t.default=s},2127:function(e,t,n){"use strict";var a=n(1216),i=n(1214);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.styles=void 0;var o=i(n(1366)),s=i(n(1272)),l=a(n(2)),r=(i(n(22)),i(n(1212))),m=i(n(1394)),c=(i(n(2128)),i(n(2129)),[0,1,2,3,4,5,6,7,8,9,10]),d=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12];function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=parseFloat(e);return"".concat(n/t).concat(String(e).replace(String(n),"")||"px")}var h=function(e){return(0,s.default)({root:{},container:{boxSizing:"border-box",display:"flex",flexWrap:"wrap",width:"100%"},item:{boxSizing:"border-box",margin:"0"},zeroMinWidth:{minWidth:0},"direction-xs-column":{flexDirection:"column"},"direction-xs-column-reverse":{flexDirection:"column-reverse"},"direction-xs-row-reverse":{flexDirection:"row-reverse"},"wrap-xs-nowrap":{flexWrap:"nowrap"},"wrap-xs-wrap-reverse":{flexWrap:"wrap-reverse"},"align-items-xs-center":{alignItems:"center"},"align-items-xs-flex-start":{alignItems:"flex-start"},"align-items-xs-flex-end":{alignItems:"flex-end"},"align-items-xs-baseline":{alignItems:"baseline"},"align-content-xs-center":{alignContent:"center"},"align-content-xs-flex-start":{alignContent:"flex-start"},"align-content-xs-flex-end":{alignContent:"flex-end"},"align-content-xs-space-between":{alignContent:"space-between"},"align-content-xs-space-around":{alignContent:"space-around"},"justify-content-xs-center":{justifyContent:"center"},"justify-content-xs-flex-end":{justifyContent:"flex-end"},"justify-content-xs-space-between":{justifyContent:"space-between"},"justify-content-xs-space-around":{justifyContent:"space-around"},"justify-content-xs-space-evenly":{justifyContent:"space-evenly"}},function(e,t){var n={};return c.forEach((function(a){var i=e.spacing(a);0!==i&&(n["spacing-".concat(t,"-").concat(a)]={margin:"-".concat(p(i,2)),width:"calc(100% + ".concat(p(i),")"),"& > $item":{padding:p(i,2)}})})),n}(e,"xs"),e.breakpoints.keys.reduce((function(t,n){return function(e,t,n){var a={};d.forEach((function(e){var t="grid-".concat(n,"-").concat(e);if(!0!==e)if("auto"!==e){var i="".concat(Math.round(e/12*1e8)/1e6,"%");a[t]={flexBasis:i,flexGrow:0,maxWidth:i}}else a[t]={flexBasis:"auto",flexGrow:0,maxWidth:"none"};else a[t]={flexBasis:0,flexGrow:1,maxWidth:"100%"}})),"xs"===n?(0,s.default)(e,a):e[t.breakpoints.up(n)]=a}(t,e,n),t}),{}))};t.styles=h;var u=l.forwardRef((function(e,t){var n=e.alignContent,a=void 0===n?"stretch":n,i=e.alignItems,m=void 0===i?"stretch":i,c=e.classes,d=e.className,p=e.component,h=void 0===p?"div":p,u=e.container,g=void 0!==u&&u,C=e.direction,f=void 0===C?"row":C,b=e.item,y=void 0!==b&&b,w=e.justify,E=e.justifyContent,v=void 0===E?"flex-start":E,x=e.lg,k=void 0!==x&&x,T=e.md,A=void 0!==T&&T,S=e.sm,R=void 0!==S&&S,O=e.spacing,M=void 0===O?0:O,D=e.wrap,I=void 0===D?"wrap":D,N=e.xl,j=void 0!==N&&N,W=e.xs,L=void 0!==W&&W,q=e.zeroMinWidth,P=void 0!==q&&q,U=(0,o.default)(e,["alignContent","alignItems","classes","className","component","container","direction","item","justify","justifyContent","lg","md","sm","spacing","wrap","xl","xs","zeroMinWidth"]),B=(0,r.default)(c.root,d,g&&[c.container,0!==M&&c["spacing-xs-".concat(String(M))]],y&&c.item,P&&c.zeroMinWidth,"row"!==f&&c["direction-xs-".concat(String(f))],"wrap"!==I&&c["wrap-xs-".concat(String(I))],"stretch"!==m&&c["align-items-xs-".concat(String(m))],"stretch"!==a&&c["align-content-xs-".concat(String(a))],"flex-start"!==(w||v)&&c["justify-content-xs-".concat(String(w||v))],!1!==L&&c["grid-xs-".concat(String(L))],!1!==R&&c["grid-sm-".concat(String(R))],!1!==A&&c["grid-md-".concat(String(A))],!1!==k&&c["grid-lg-".concat(String(k))],!1!==j&&c["grid-xl-".concat(String(j))]);return l.createElement(h,(0,s.default)({className:B,ref:t},U))})),g=(0,m.default)(h,{name:"MuiGrid"})(u);t.default=g},2128:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){return null};return function(t){return function(n,a,i,o,s){var l=s||a;return void 0===n[a]||n[t]?null:new Error("The prop `".concat(l,"` of ")+"`".concat(e,"` must be used on `").concat(t,"`."))}}}},2129:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return function(){return null};return function(e,n,a,i,o){var s=a||"<<anonymous>>",l=o||n;return void 0!==e[n]?new Error("The ".concat(i," `").concat(l,"` of ")+"`".concat(s,"` is deprecated. ").concat(t)):null}}},2626:function(e,t,n){"use strict";n.r(t);var a=n(2),i=n.n(a),o=n(22),s=n.n(o),l=n(1213),r=n(1660),m=n(1655),c=n(2127),d=n.n(c),p=n(1678),h=n(4988),u=n(1653),g=n(361),C=n(1238),f=n.n(C),b=n(4978),y=n(1292),w=n(1548),E=n(2126),v=n.n(E),x=n(1664),k=n(4991),T=n(1679),A=n(4986),S=n(1927),R=n.n(S),O=n(1928),M=n.n(O),D=n(1225),I=n(1698),N=n(1921),j=n(1922),W=n(1923),L=n(1924);class q extends i.a.Component{handleRequestClose(e){const{callback:t}=this.props;e===q.Action.OK?t(!0):t(!1)}render(){const{title:e,message:t,labelCancel:n,labelOk:a,open:o,classes:s}=this.props;return i.a.createElement(I.a,{role:"alertdialog",open:o,onClose:this.handleRequestClose,className:s.dialogWrapper},i.a.createElement(N.a,null,e||i.a.createElement(u.a,{id:"Shared.ConfirmDialog.please.confirm",defaultMessage:"Please Confirm"})),i.a.createElement(j.a,null,i.a.createElement(W.a,null,t||i.a.createElement(u.a,{id:"Shared.ConfirmDialog.please.confirm.sure",defaultMessage:"Are you sure?"}))),i.a.createElement(L.a,null,i.a.createElement(p.a,{onClick:()=>this.handleRequestClose(q.Action.CANCEL),color:"primary"},n||i.a.createElement(u.a,{id:"Shared.ConfirmDialog.cancel",defaultMessage:"Cancel"})),i.a.createElement(p.a,{onClick:()=>this.handleRequestClose(q.Action.OK),color:"primary",variant:"contained",className:s.deleteConformButton},a||i.a.createElement(u.a,{id:"Shared.ConfirmDialog.ok",defaultMessage:"OK"}))))}}q.propTypes={title:s.a.string.isRequired,message:s.a.string.isRequired,labelCancel:s.a.string.isRequired,labelOk:s.a.string.isRequired,callback:s.a.func.isRequired,open:s.a.bool.isRequired},q.Action={OK:"ok",CANCEL:"cancel"};var P=Object(l.a)(e=>({dialogWrapper:{"& span, & h5, & label, & td, & li, & div, & p":{color:e.palette.getContrastText(e.palette.background.paper)}},deleteConformButton:{"& span.MuiButton-label":{color:e.palette.getContrastText(e.palette.primary.main)}}}))(q),U=n(352),B=n(1656),z=n(2215),F=n(1662),_=n(1794);class G extends i.a.Component{constructor(e){super(e),this.state={commentText:"",category:"",currentLength:0},this.inputChange=this.inputChange.bind(this),this.handleCategoryChange=this.handleCategoryChange.bind(this),this.handleClickUpdateComment=this.handleClickUpdateComment.bind(this),this.handleClickCancel=this.handleClickCancel.bind(this),this.filterCommentToUpdate=this.filterCommentToUpdate.bind(this),this.filterCommentToUpdateReply=this.filterCommentToUpdateReply.bind(this)}componentDidMount(){const{comment:e}=this.props;this.setState({commentText:e.commentText,category:e.category,currentLength:e.commentText.length})}inputChange(e){let{target:t}=e;this.setState({commentText:t.value,currentLength:t.value.length})}handleClickCancel(){const{toggleShowEdit:e,commentsUpdate:t,allComments:n}=this.props;e(),t(n)}handleCategoryChange(e){this.setState({category:e.target.value})}filterCommentToUpdate(e){const{comment:t}=this.props;return e.commentId===t.commentId}filterCommentToUpdateReply(e){const{comment:t}=this.props;return e.commentId===t.parentCommentId}handleClickUpdateComment(){const{apiId:e,comment:t,allComments:n,toggleShowEdit:a,commentsUpdate:i,intl:o}=this.props,{category:s,commentText:l}=this.state,r=new U.a,m=t;m.commentText=l.trim(),m.category=s,t.commentText.replace(/\s/g,"").length?r.updateComment(e,m.commentId,m).then(e=>{const t=e.body;if(void 0===m.parentCommentId){const e=n.findIndex(this.filterCommentToUpdate);n[e].category=t.category,n[e].commentText=t.commentText}else{const e=n.findIndex(this.filterCommentToUpdateReply),a=n[e].replies.findIndex(this.filterCommentToUpdate);n[e].replies[a]=t}a(),i(n)}).catch(e=>{console.error(e),e.response?D.a.error(e.response.body.message):D.a.error(o.formatMessage({defaultMessage:"Something went wrong while adding the comment",id:"Apis.Details.Comments.CommentEdit.something.went.wrong"}))}):D.a.error(o.formatMessage({defaultMessage:"You cannot enter a blank comment",id:"Apis.Details.Comments.CommentEdit.blank.comment.error"}))}render(){const{classes:e,theme:t,intl:n}=this.props,{category:a,commentText:o,currentLength:s}=this.state;return i.a.createElement("div",null,i.a.createElement(z.a,{className:e.category},i.a.createElement(_.a,{value:a,onChange:this.handleCategoryChange},i.a.createElement(F.a,{value:"General"},i.a.createElement(u.a,{id:"Apis.Details.Comments.CommentEdit.general",defaultMessage:"General"})),i.a.createElement(F.a,{value:"Feature Request"},i.a.createElement(u.a,{id:"Apis.Details.Comments.CommentEdit.feature.request",defaultMessage:"Feature Request"})),i.a.createElement(F.a,{value:"Bug Report"},i.a.createElement(u.a,{id:"Apis.Details.Comments.CommentEdit.bug.report",defaultMessage:"Bug Report"})))),i.a.createElement(B.a,{id:"multiline-static",autoFocus:!0,multiline:!0,className:e.textField,margin:"normal",placeholder:n.formatMessage({defaultMessage:"Write a comment",id:"Apis.Details.Comments.CommentEdit.write.a.comment"}),inputProps:{maxLength:t.custom.maxCommentLength},value:o,onChange:this.inputChange}),i.a.createElement(m.a,{className:e.commentText,align:"right"},s+"/"+t.custom.maxCommentLength),i.a.createElement(T.a,{container:!0,spacing:1},i.a.createElement(T.a,{item:!0},i.a.createElement(p.a,{variant:"contained",color:"primary",onClick:()=>this.handleClickUpdateComment()},i.a.createElement(u.a,{id:"Apis.Details.Comments.CommentEdit.btn.save",defaultMessage:"Save"}))),i.a.createElement(T.a,{item:!0},i.a.createElement(p.a,{onClick:()=>this.handleClickCancel(),className:e.button},i.a.createElement(u.a,{id:"Apis.Details.Comments.CommentEdit.btn.cancel",defaultMessage:"Cancel"})))))}}G.defaultProps={commentsUpdate:null},G.propTypes={classes:s.a.instanceOf(Object).isRequired,apiId:s.a.string.isRequired,allComments:s.a.instanceOf(Array).isRequired,commentsUpdate:s.a.func,toggleShowEdit:s.a.func.isRequired,comment:s.a.instanceOf(Object).isRequired,intl:s.a.shape({formatMessage:s.a.func}).isRequired};var K=Object(g.c)(Object(l.a)(e=>({textField:{marginTop:0,width:"87.5%"},contentWrapper:{maxWidth:e.custom.contentAreaWidth,paddingLeft:e.spacing(2),paddingTop:e.spacing.unig,marginTop:e.spacing(2)},category:{width:"12%",marginRight:"0.5%"}}),{withTheme:!0})(G)),Y=n(48);class J extends i.a.Component{constructor(e){super(e),this.state={},this.showAddComment=this.showAddComment.bind(this),this.showEditComment=this.showEditComment.bind(this),this.handleClickOpen=this.handleClickOpen.bind(this)}showAddComment(e){const{showAddComment:t}=this.props;t(e)}showEditComment(e){const{editIndex:t,showEditComment:n}=this.props;-1===t&&n(e)}handleClickOpen(e){const{editIndex:t,handleClickOpen:n}=this.props;-1===t&&n(e)}displayDate(e){const t=new Date(e);return t.toLocaleDateString(void 0,{day:"numeric",month:"short",year:"numeric"})+" "+t.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})}render(){const{classes:e,comment:t,editIndex:n,index:a,theme:o}=this.props,s=Y.a.getUser(),l=s&&s.name,r=t.createdBy===l||s&&s.isAdmin();return i.a.createElement(T.a,{container:!0,className:e.verticalSpace,key:t.id},r&&[i.a.createElement(T.a,{item:!0,key:"key-delete"},i.a.createElement(p.a,{size:"small",className:-1===n?e.link:e.disable,onClick:()=>this.handleClickOpen(t),color:"primary","aria-label":"Delete comment "+t.content},i.a.createElement(u.a,{id:"Apis.Details.Comments.CommentOptions.delete",defaultMessage:"Delete"})))],null===t.parentCommentId&&Y.a.getUser()&&[i.a.createElement(T.a,{item:!0,key:"key-reply"},i.a.createElement(p.a,{size:"small",className:e.link,onClick:()=>this.showAddComment(t.id),color:"primary","aria-label":"Reply to comment "+t.content},i.a.createElement(u.a,{id:"Apis.Details.Comments.CommentOptions.reply",defaultMessage:"Reply"})))])}}J.defaultProps={showAddComment:null},J.propTypes={classes:s.a.instanceOf(Object).isRequired,editIndex:s.a.number.isRequired,index:s.a.number.isRequired,comment:s.a.instanceOf(Object).isRequired,handleClickOpen:s.a.func.isRequired,showEditComment:s.a.func.isRequired,showAddComment:s.a.func};var H=Object(l.a)(e=>({link:{color:e.palette.getContrastText(e.palette.primary.main),"& span.MuiButton-label":{color:e.palette.primary.main,fontWeight:"400"},cursor:"pointer"},time:{color:e.palette.getContrastText(e.palette.background.default),marginTop:e.spacing(.3)},verticalSpace:{display:"flex",alignItems:"center"},disable:{color:e.palette.grey[200]},commentIcon:{color:e.palette.getContrastText(e.palette.background.default)},commentText:{color:e.palette.getContrastText(e.palette.background.default),marginTop:e.spacing.unig,width:"100%",whiteSpace:"pre-wrap",overflowWrap:"break-word"},root:{marginTop:e.spacing(2.5)},contentWrapper:{maxWidth:e.custom.contentAreaWidth,paddingLeft:e.spacing(2),paddingTop:e.spacing.unig}}),{withTheme:!0})(J),V=n(2628);function $(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Q extends i.a.Component{constructor(e){super(e),$(this,"handleCancel",()=>{const{cancelCallback:e}=this.props;e?e():this.handleClickCancel(-1)}),this.state={content:"",currentLength:0},this.inputChange=this.inputChange.bind(this),this.handleClickAddComment=this.handleClickAddComment.bind(this),this.handleClickCancel=this.handleClickCancel.bind(this),this.filterCommentToAddReply=this.filterCommentToAddReply.bind(this)}inputChange(e){let{target:t}=e;this.setState({content:t.value,currentLength:t.value.length})}handleClickCancel(){this.setState({content:""});const{handleShowReply:e}=this.props;e(-1)}filterCommentToAddReply(e){const{replyTo:t}=this.props;return e.id===t}handleClickAddComment(){const{apiId:e,intl:t,replyTo:n,handleShowReply:a,addComment:i,addReply:o}=this.props,{content:s}=this.state,l=new U.a,r={content:s.trim(),category:"general"};r.content.replace(/\s/g,"").length?l.addComment(e,r,n).then(e=>{this.setState({content:""}),null===n?i&&i(e.body):o&&o(e.body)}).catch(e=>{console.error(e),e.response&&e.response.body&&e.response.body.message?D.a.error(e.response.body.message):D.a.error(t.formatMessage({defaultMessage:"Something went wrong while adding the comment",id:"Apis.Details.Comments.CommentAdd.something.went.wrong"}))}):D.a.error(t.formatMessage({defaultMessage:"You cannot enter a blank comment",id:"Apis.Details.Comments.CommentAdd.error.blank.comment"})),this.setState({currentLength:0}),null!==n&&a()}render(){const{classes:e,cancelButton:t,theme:n,intl:a}=this.props,{content:o,currentLength:s}=this.state;return i.a.createElement(T.a,{container:!0,spacing:1,className:e.contentWrapper},i.a.createElement(T.a,{item:!0,xs:!0,zeroMinWidth:!0},i.a.createElement("div",{className:e.commentAddWrapper},i.a.createElement(V.a,{htmlFor:"standard-multiline-flexible"},i.a.createElement(u.a,{id:"Apis.Details.Comments.CommentAdd.write.comment.label",defaultMessage:"Write a comment"})),i.a.createElement(B.a,{id:"standard-multiline-flexible",autoFocus:!0,multiline:!0,rows:"4",className:e.textField,margin:"normal",placeholder:a.formatMessage({defaultMessage:"Write a comment",id:"Apis.Details.Comments.CommentAdd.write.comment.help"}),inputProps:{maxLength:n.custom.maxCommentLength},value:o,onChange:this.inputChange,variant:"outlined"}),i.a.createElement(m.a,{className:e.content,align:"right"},s+"/"+n.custom.maxCommentLength)),i.a.createElement(T.a,{container:!0,spacing:1},i.a.createElement(T.a,{item:!0},i.a.createElement(p.a,{variant:"contained",color:"primary",disabled:0===s,onClick:()=>this.handleClickAddComment(),className:e.commentAddButton},i.a.createElement(u.a,{id:"Apis.Details.Comments.CommentAdd.btn.add.comment",defaultMessage:"Comment"}))),t&&i.a.createElement(T.a,{item:!0},i.a.createElement(p.a,{onClick:this.handleCancel,className:e.button},i.a.createElement(u.a,{id:"Apis.Details.Comments.CommentAdd.btn.cancel",defaultMessage:"Cancel"}))))))}}Q.defaultProps={replyTo:null,handleShowReply:null,commentsUpdate:null,cancelCallback:null},Q.propTypes={classes:s.a.instanceOf(Object).isRequired,cancelButton:s.a.bool.isRequired,apiId:s.a.string.isRequired,replyTo:s.a.string,handleShowReply:s.a.func,commentsUpdate:s.a.func,allComments:s.a.instanceOf(Array).isRequired,intl:s.a.shape({formatMessage:s.a.func}).isRequired,cancelCallback:s.a.func};var X=Object(g.c)(Object(l.a)(e=>({commentIcon:{color:e.palette.getContrastText(e.palette.background.default)},content:{color:e.palette.getContrastText(e.palette.background.default)},contentWrapper:{maxWidth:e.custom.contentAreaWidth,paddingLeft:e.spacing(2),paddingTop:e.spacing(1),marginTop:e.spacing(2)},textField:{marginTop:0,marginRight:5,width:"100%"},commentAddWrapper:{display:"flex",alignItems:"top",flexFlow:"column","& label":{marginBottom:e.spacing(1)}},commentAddButton:{"& span.MuiButton-label":{color:e.palette.getContrastText(e.palette.primary.main)}}}),{withTheme:!0})(Q));function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){te(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function te(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}R.a.extend(M.a);class ne extends i.a.Component{constructor(e){super(e),this.state={openDialog:!1,replyId:-1,editIndex:-1,deleteComment:null},this.handleClickDeleteComment=this.handleClickDeleteComment.bind(this),this.handleShowEdit=this.handleShowEdit.bind(this),this.handleShowReply=this.handleShowReply.bind(this),this.handleClickOpen=this.handleClickOpen.bind(this),this.showAddComment=this.showAddComment.bind(this),this.showEditComment=this.showEditComment.bind(this),this.handleConfirmDialog=this.handleConfirmDialog.bind(this),this.handleClose=this.handleClose.bind(this),this.filterRemainingComments=this.filterRemainingComments.bind(this),this.filterCommentToDelete=this.filterCommentToDelete.bind(this),this.handleLoadMoreReplies=this.handleLoadMoreReplies.bind(this),this.handleAddReply=this.handleAddReply.bind(this),this.handleDeleteReply=this.handleDeleteReply.bind(this)}filterRemainingComments(e){const{deleteComment:t}=this.state;return e.id!==t.id}filterCommentToDelete(e){const{deleteComment:t}=this.state;return e.id===t.parentCommentId}showAddComment(e){this.setState({replyId:e})}showEditComment(e){const{editIndex:t}=this.state;-1===t&&this.setState({editIndex:e})}handleShowEdit(){this.setState({editIndex:-1})}handleShowReply(){this.setState({replyId:-1})}handleClickOpen(e){const{editIndex:t}=this.state;-1===t&&this.setState({deleteComment:e,openDialog:!0})}handleClose(){this.setState({openDialog:!1})}handleConfirmDialog(e){e?this.handleClickDeleteComment():this.handleClose()}handleClickDeleteComment(){const e=new U.a,{deleteComment:t}=this.state,{apiId:n,intl:a,onDeleteComment:i}=this.props,o=t.id,s=t.parentCommentId;this.handleClose(),e.deleteComment(n,o).then(()=>{null===s?(i&&i(o),D.a.info(a.formatMessage({defaultMessage:"Comment has been successfully deleted",id:"Apis.Details.Comments.Comment.comment.deleted"}))):(this.handleDeleteReply(s,o),D.a.info(a.formatMessage({defaultMessage:"Reply comment has been successfully deleted",id:"Apis.Details.Comments.Comment.reply.comment.deleted"})))}).catch(e=>{console.error(e),e.response?D.a.error(e.response.body.message):D.a.error(a.formatMessage({defaultMessage:"Something went wrong while deleting comment",id:"Apis.Details.Comments.Comment.something.went.wrong"})+" - "+o)})}handleLoadMoreReplies(e){const{apiId:t,comments:n,updateComment:a}=this.props,{id:i,replies:{count:o,list:s}}=e;(new U.a).getAllCommentReplies(t,i,3,o).then(e=>{if(e.body){const{list:t,count:l}=e.body,r=n.find(e=>e.id===i),m=s.concat(t),c=o+l,d=c<=3?3:c,p=ee(ee({},r),{},{replies:{count:c,list:m,pagination:ee(ee({},r.replies.pagination),{},{limit:d})}});a&&a(p)}}).catch(e=>{0})}handleDeleteReply(e,t){const{comments:n,updateComment:a,apiId:i}=this.props,o=n.find(t=>t.id===e),{replies:s}=o,l=s.list.filter(e=>e.id!==t),r=s.pagination.total-1,m=s.pagination.limit>r?r:s.pagination.limit,c=s.count-1;if(r>c){(new U.a).getAllCommentReplies(i,e,1,m-1).then(e=>{if(e.body){const t=ee(ee({},o),{},{replies:ee(ee({},s),{},{list:[...l,...e.body.list],pagination:ee(ee({},s.pagination),{},{total:r})})});a&&a(t)}}).catch(e=>{0})}else{const e=ee(ee({},o),{},{replies:ee(ee({},s),{},{count:c,list:l,pagination:ee(ee({},s.pagination),{},{limit:m,total:r})})});a&&a(e)}}handleAddReply(e){const{comments:t,updateComment:n}=this.props,{parentCommentId:a}=e,i=t.find(e=>e.id===a),{replies:o}=i,s=(o.count||0)+1,l=s<=3?3:s,r=ee(ee({},i),{},{replies:ee(ee({},o),{},{count:s,list:[...o.list,e],pagination:ee(ee({},o.pagination),{},{limit:l,offset:o.pagination.offset||0,total:o.pagination.total+1})})});n&&n(r)}render(){const{classes:e,comments:t,apiId:n,allComments:a,isOverview:o,isCrossTenantUser:s}=this.props,{editIndex:l,openDialog:r,replyId:c}=this.state;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:f()({[e.paper]:!o&&t.length>0},{[e.cleanBack]:o})},t&&t.slice(0).map((t,r)=>i.a.createElement("div",{key:t.id+"-"+r,className:f()({[e.contentWrapper]:!o},{[e.contentWrapperOverview]:o})},0!==r&&i.a.createElement(A.a,{className:e.divider}),i.a.createElement(T.a,{md:8,container:!0,spacing:1,className:f()({[e.root]:!o})},i.a.createElement(T.a,{item:!0},i.a.createElement(k.a,{className:e.commentIcon},"account_circle")),i.a.createElement(T.a,{item:!0,xs:!0,zeroMinWidth:!0},i.a.createElement(m.a,{noWrap:!0,className:e.commentText},t.commenterInfo&&t.commenterInfo.firstName?t.commenterInfo.firstName+t.commenterInfo.lastName:t.createdBy),i.a.createElement(x.a,{title:t.createdTime,"aria-label":t.createdTime},i.a.createElement(m.a,{noWrap:!0,className:e.commentText,variant:"caption"},R()(t.createdTime).fromNow())),i.a.createElement(m.a,{className:e.commentText},t.content),!s&&i.a.createElement(H,{comment:t,editIndex:l,index:r,showAddComment:this.showAddComment,handleClickOpen:this.handleClickOpen,showEditComment:this.showEditComment}),t.id===c&&i.a.createElement(h.a,{ml:6,mb:2},i.a.createElement(X,{apiId:n,replyTo:t.id,allComments:a,handleShowReply:this.handleShowReply,cancelButton:!0,addReply:this.handleAddReply})),t.replies&&t.replies.list.map((a,o)=>i.a.createElement(i.a.Fragment,null,i.a.createElement(h.a,{ml:8},0!==o&&i.a.createElement(A.a,{className:e.divider}),i.a.createElement(T.a,{container:!0,spacing:1,className:e.root},i.a.createElement(T.a,{item:!0},i.a.createElement(k.a,{className:e.commentIcon},"account_circle")),i.a.createElement(T.a,{item:!0,xs:!0,zeroMinWidth:!0},i.a.createElement(m.a,{noWrap:!0,className:e.commentText},a.commenterInfo&&a.commenterInfo.fullName?a.commenterInfo.fullName:a.createdBy),i.a.createElement(x.a,{title:t.createdTime,"aria-label":t.createdTime},i.a.createElement(m.a,{noWrap:!0,className:e.commentText,variant:"caption"},R()(a.createdTime).fromNow())),o!==l&&i.a.createElement(m.a,{className:e.commentText},a.content),o===l&&i.a.createElement(K,{apiId:n,allComments:a,comment:a,toggleShowEdit:this.handleShowEdit}),!s&&i.a.createElement(H,{comment:a,editIndex:l,index:o,showAddComment:this.showAddComment,handleClickOpen:this.handleClickOpen,showEditComment:this.showEditComment})))))),t.replies&&t.replies.count<t.replies.pagination.total&&i.a.createElement("div",{className:e.contentWrapper},i.a.createElement(T.a,{container:!0,spacing:4,className:e.root},i.a.createElement(T.a,{item:!0},i.a.createElement(m.a,{className:e.verticalSpace,variant:"body1"},i.a.createElement("a",{className:e.link+" "+e.loadMoreLink,onClick:()=>this.handleLoadMoreReplies(t),onKeyDown:()=>this.handleLoadMoreReplies(t)},i.a.createElement(u.a,{id:"Apis.Details.Comments.Comment.load.more.replies",defaultMessage:"Show More Replies"})))),i.a.createElement(T.a,{item:!0},i.a.createElement(m.a,{className:e.verticalSpace,zvariant:"body1"},"("+t.replies.count+" of "+t.replies.pagination.total+")"))))))))),i.a.createElement(P,{key:"key-dialog",labelCancel:i.a.createElement(u.a,{id:"Apis.Details.Comments.Comment.delete.dialog.label.cancel",defaultMessage:"Cancel"}),title:i.a.createElement(u.a,{id:"Apis.Details.Comments.Comment.delete.dialog.title",defaultMessage:"Confirm Delete"}),message:i.a.createElement(u.a,{id:"Apis.Details.Comments.Comment.delete.dialog.message",defaultMessage:"Are you sure you want to delete this comment?"}),labelOk:i.a.createElement(u.a,{id:"Apis.Details.Comments.Comment.delete.dialog.label.ok",defaultMessage:"Yes"}),callback:this.handleConfirmDialog,open:r}))}}ne.defaultProps={isOverview:!1},ne.propTypes={classes:s.a.shape({}).isRequired,apiId:s.a.string.isRequired,allComments:s.a.instanceOf(Array).isRequired,comments:s.a.instanceOf(Array).isRequired,isOverview:s.a.bool,isCrossTenantUser:s.a.bool.isRequired,updateComment:s.a.func.isRequired};var ae=Object(g.c)(Object(l.a)(e=>({link:{color:e.palette.getContrastText(e.palette.background.default),cursor:"pointer"},commentIcon:{color:e.palette.getContrastText(e.palette.background.default)},commentText:{color:e.palette.getContrastText(e.palette.background.default),marginTop:0,width:"99%",whiteSpace:"pre-wrap",overflowWrap:"break-word",wordBreak:"break-all"},root:{marginTop:e.spacing(1)},contentWrapper:{paddingLeft:e.spacing(2),paddingTop:e.spacing(1)},contentWrapperOverview:{background:"transparent",width:"100%"},divider:{marginTop:e.spacing(2),marginBottom:e.spacing(2),width:"60%"},paper:{margin:0,marginTop:e.spacing(1),marginRight:e.spacing(3),paddingBottom:e.spacing(3)},cleanBack:{background:"transparent",width:"100%",boxShadow:"none"}}))(ne)),ie=n(1239);class oe extends a.Component{constructor(e){super(e),this.state={expanded:!0,allComments:null,comments:[],totalComments:0,apiId:null,showCommentAdd:!1},this.handleExpandClick=this.handleExpandClick.bind(this),this.handleLoadMoreComments=this.handleLoadMoreComments.bind(this),this.toggleCommentAdd=this.toggleCommentAdd.bind(this),this.addComment=this.addComment.bind(this),this.updateComment=this.updateComment.bind(this),this.onDeleteComment=this.onDeleteComment.bind(this),this.isCrossTenant=this.isCrossTenant.bind(this)}componentDidMount(){let{apiId:e,theme:t,match:n,intl:a,isOverview:i,setCount:o}=this.props;n&&(e=n.params.apiUuid),this.setState({apiId:e});const s=new U.a,l=t.custom.commentsLimit;s.getAllComments(e,l,0).then(e=>{let t=e.body.list;i&&(o(t.length),t.length>2&&(t=t.slice(t.length-3,t.length))),this.setState({allComments:t,comments:t,totalComments:e.body.pagination.total})}).catch(e=>{0})}handleLoadMoreComments(){const{allComments:e,apiId:t,comments:n}=this.state,{theme:a}=this.props,i=new U.a,o=a.custom.commentsLimit,s=n.length;i.getAllComments(t,o,s).then(t=>{const n=e.concat(t.body.list);this.setState({allComments:n,comments:n})}).catch(e=>{0})}handleExpandClick(){const{expanded:e}=this.state;this.setState({expanded:!e})}addComment(e){const{totalComments:t,allComments:n}=this.state,{theme:{custom:{commentsLimit:a}}}=this.props,i=t+1;this.setState({allComments:[e,...n],totalComments:i,comments:[e,...n]})}updateComment(e){const{comments:t}=this.state,n=t.reduce((t,n)=>{let a=n;return n.id===e.id&&(a=e),[...t,a]},[]);this.setState({allComments:n,comments:n})}onDeleteComment(e){const{apiId:t,comments:n,totalComments:a}=this.state,i=n.filter(t=>t.id!==e),o=a-1;if(o>i.length){(new U.a).getAllComments(t,1,i.length).then(e=>{e.body&&this.setState({totalComments:o,comments:[...i,...e.body.list],allComments:[...i,...e.body.list]})}).catch(e=>{0})}else this.setState({totalComments:o,comments:i,allComments:i})}isCrossTenant(e,t){if(!t)return!1;let n=null;const a=e.name;if(a.includes("@")){const e=a.split("@");n=e[e.length-1]}else n="carbon.super";return t!==n}toggleCommentAdd(){this.setState(e=>({showCommentAdd:!e.showCommentAdd}))}render(){const{classes:e,isOverview:t,tenantDomain:n}=this.props,{comments:a,allComments:o,totalComments:s,showCommentAdd:l}=this.state,c=Y.a.getUser()&&this.isCrossTenant(Y.a.getUser(),n);return i.a.createElement(ie.a.Consumer,null,n=>{let{api:g}=n;return i.a.createElement("div",{className:f()({[e.contentWrapper]:!t},{[e.contentWrapperOverview]:t})},!t&&i.a.createElement("div",{className:e.root},i.a.createElement(m.a,{variant:"h4",component:"h2",className:e.titleSub},s+" ",i.a.createElement(u.a,{id:"Apis.Details.Comments.title",defaultMessage:"Comments"}))),!c&&Y.a.getUser()&&i.a.createElement(h.a,{mt:2,ml:1},!l&&i.a.createElement(p.a,{color:"primary",size:"small",className:e.button,startIcon:i.a.createElement(v.a,null),onClick:this.toggleCommentAdd},i.a.createElement(u.a,{id:"Apis.Details.Comments.write.a.new.comment",defaultMessage:"Write a New Comment"})),l&&i.a.createElement(X,{apiId:g.id,commentsUpdate:this.addComment,addComment:this.addComment,allComments:o,replyTo:null,cancelCallback:this.toggleCommentAdd,cancelButton:!0})),!o&&i.a.createElement(r.a,{className:e.paperProgress},i.a.createElement(b.a,{size:24})),o&&0===s&&i.a.createElement(h.a,{mt:2,mb:2,ml:1},i.a.createElement(y.a,{type:"info",title:i.a.createElement(u.a,{id:"Apis.Details.Comments.no.comments",defaultMessage:"No Comments Yet"})},i.a.createElement(m.a,{component:"p"},i.a.createElement(u.a,{id:"Apis.Details.Comments.no.comments.content",defaultMessage:"No comments available for this API yet"})))),i.a.createElement(ae,{comments:a,isCrossTenantUser:c,apiId:g.id,allComments:o,onDeleteComment:this.onDeleteComment,updateComment:this.updateComment}),s>a.length&&i.a.createElement("div",{className:e.contentWrapper},i.a.createElement(d.a,{container:!0,spacing:4,className:e.root},i.a.createElement(d.a,{item:!0},i.a.createElement(m.a,{className:e.verticalSpace,variant:"body1"},i.a.createElement("a",{className:e.link+" "+e.loadMoreLink,onClick:this.handleLoadMoreComments},i.a.createElement(u.a,{id:"Apis.Details.Comments.load.previous.comments",defaultMessage:"Show More"})))),i.a.createElement(d.a,{item:!0},i.a.createElement(m.a,{className:e.verticalSpace,variant:"body1"},"("+a.length+" of "+s+")")))))})}}var se,le,re;se=oe,le="contextType",re=ie.a,(le=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(le))in se?Object.defineProperty(se,le,{value:re,enumerable:!0,configurable:!0,writable:!0}):se[le]=re,oe.defaultProps={setCount:()=>{}},oe.propTypes={classes:s.a.instanceOf(Object).isRequired,setCount:s.a.func};t.default=Object(g.c)(Object(l.a)(e=>({root:{display:"flex",alignItems:"center",paddingTop:e.spacing(2),paddingBottom:e.spacing(2)},paper:{marginRight:e.spacing(3),paddingBottom:e.spacing(3),paddingRight:e.spacing(2),"& span, & h5, & label, & td, & li, & div, & input":{color:e.palette.getContrastText(e.palette.background.paper)}},contentWrapper:{paddingLeft:e.spacing(3),marginTop:e.spacing(1)},contentWrapperOverview:{padding:0,width:"100%",boxShadow:"none"},titleSub:{cursor:"pointer",color:e.palette.getContrastText(e.palette.background.default)},link:{color:e.palette.getContrastText(e.palette.background.default),cursor:"pointer"},verticalSpace:{marginTop:e.spacing(.2)},loadMoreLink:{textDecoration:"none"},genericMessageWrapper:{marginTop:e.spacing(2),marginBottom:e.spacing(2),marginRight:e.spacing(3)},paperProgress:{padding:e.spacing(3),marginTop:e.spacing(2)},button:{textTransform:"capitalize"}}),{withTheme:!0})(Object(w.a)(oe)))}}]);
//# sourceMappingURL=APIComments.398a89a8736f03318e5c.bundle.js.map