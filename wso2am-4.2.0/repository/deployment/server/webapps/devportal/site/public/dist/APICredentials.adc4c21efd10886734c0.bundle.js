(this.webpackJsonp=this.webpackJsonp||[]).push([[24],{1307:function(e,a,t){"use strict";t.d(a,"a",(function(){return p})),t.d(a,"b",(function(){return c})),t.d(a,"c",(function(){return o}));var n=t(2),s=t.n(n),r=t(22),i=t.n(r),l=t(48);const o={APIS:"/apis",SINGLE_API:"/apis/{apiId}",API_SWAGGER:"/apis/{apiId}/swagger",API_WSDL:"/apis/{apiId}/wsdl",API_GW_CONFIG:"/apis/{apiId}/gateway-config",API_THUMBNAIL:"/apis/{apiId}/thumbnail",API_COPY:"/apis/copy-api",API_LC_HISTORY:"/apis/{apiId}/lifecycle-history",API_CHANGE_LC:"/apis/change-lifecycle",API_LC:"/apis/{apiId}/lifecycle",API_LC_PENDING_TASK:"/apis/{apiId}/lifecycle/lifecycle-pending-task",API_DEF:"/apis/import-definition",API_VALIDATE_DEF:"/apis/validate-definition",API_DOCS:"/apis/{apiId}/documents",API_DOC:"'/apis/{apiId}/documents/{documentId}'",API_DOC_CONTENT:"'/apis/{apiId}/documents/{documentId}/content'",APPLICATIONS:"/applications",SINGLE_APPLICATION:"/applications/{applicationId}",APPLICATION_GENERATE_KEYS:"/applications/{applicationId}/generate-keys",APPLICATION_GENERATE_KEY_TYPE:"/applications/{applicationId}/keys/{keyType}",EXPORT_APIS:"/export/apis",IMPORT_APIS:"/import/apis",SUBSCRIPTION:"/subscriptions",SINGLE_SUBSCRIPTION:"/subscriptions/{subscriptionId}",SUBSCRIPTIONS:"/subscriptions",BLOCK_SUBSCRIPTION:"/subscriptions/block-subscription:",UNBLOCK_SUBSCRIPTION:"/subscriptions/unblock-subscription",POLICIES:"'/policies/{tierLevel}'",POLICY:"'/policies/{tierLevel}/{tierName}'",ENDPOINTS:"/endpoints",ENDPOINT:"/endpoints/{endpointId}",LABLES:"/labels",WORKFLOW:"/workflows/{workflowReferenceId}",SERVICE_DISCOVERY:"/external-resources/services"},c={POST:"post",PUT:"put",GET:"get",DELETE:"delete"};class p extends s.a.Component{constructor(e){super(e),this.state={}}componentDidMount(){const{resourcePath:e,resourceMethod:a}=this.props,t=l.a.hasScopes(e,a);t&&t.then(e=>{this.setState({haveScope:e})})}render(){const{children:e}=this.props;return this.state.haveScope&&e||null}}p.propTypes={children:i.a.node.isRequired,resourcePath:i.a.string.isRequired,resourceMethod:i.a.string.isRequired}},1552:function(e,a,t){"use strict";var n=t(1919),s=t.n(n);const r={number:s.a.number().integer(),url:s.a.string().uri().allow(""),ipAddress:s.a.string().ip({version:["ipv4","ipv6"],cidr:"optional"})};a.a=r},1553:function(e,a,t){"use strict";t.d(a,"a",(function(){return i}));var n=t(150),s=t(171),r=t(11);class i extends s.a{constructor(){super(),this.client=(new n.a).getAPIClient(r.a.getEnvironment().label).client}getSubscriptions(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25;return this.client.then(n=>n.apis.Subscriptions.get_subscriptions({apiId:e,applicationId:a,limit:t}))}getSubscription(e){return this.client.then(a=>a.apis.Subscriptions.get_subscriptions__subscriptionId_({subscriptionId:e}))}getMonetizationInvoice(e){return this.client.then(a=>a.apis["API Monetization"].get_subscriptions__subscriptionId__usage({subscriptionId:e}))}deleteSubscription(e){return this.client.then(a=>a.apis.Subscriptions.delete_subscriptions__subscriptionId_({subscriptionId:e}))}updateSubscription(e,a,t,n,s,r){return this.client.then(i=>{let l=null;l={applicationId:e,apiId:a,subscriptionId:t,throttlingPolicy:n,status:s,requestedThrottlingPolicy:r};const o={subscriptionId:t};return i.apis.Subscriptions.put_subscriptions__subscriptionId_(o,{requestBody:l},{"Content-Type":"application/json"})})}}},2192:function(e,a,t){"use strict";var n=t(2),s=t.n(n),r=t(22),i=t.n(r),l=t(1213),o=t(1678),c=t(4988),p=t(1655),d=t(1653),u=t(361),m=t(1288),g=t(4978),y=t(4992),h=t(4905),b=t(2763),E=t(1225),f=t(1698),k=t(1924),A=t(1922),T=t(1921),S=t(1925),C=t.n(S),v=t(1307),M=t(1412),K=t(2219),w=t(2215),x=t(1679),O=t(1656);function P(e){const{consumerKey:a,consumerSecret:t,onChange:n,isUserOwner:r,key:i,provideOAuthKeySecret:l,importDisabled:c}=e,u=Object(M.a)(),[m,g]=s.a.useState(!1),y=()=>{g(!1)};function h(e){n&&n(e)}return s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{variant:"outlined",color:"secondary",startIcon:s.a.createElement(C.a,null),onClick:()=>{g(!0)},disabled:c},s.a.createElement(d.a,{defaultMessage:"Provide Existing OAuth Keys",id:"Shared.AppsAndKeys.ImportExternalApp.provide.oauth"})),s.a.createElement(f.a,{open:m,onClose:y,"aria-labelledby":"form-dialog-title"},s.a.createElement(T.a,{id:"form-dialog-title"},s.a.createElement(d.a,{defaultMessage:"Provide Existing OAuth Keys",id:"Shared.AppsAndKeys.ImportExternalApp.provide.oauth"})),s.a.createElement(A.a,null,s.a.createElement(x.a,{container:!0,spacing:3,direction:"column"},s.a.createElement(x.a,{item:!0,xs:12},s.a.createElement(O.a,{id:"provided-consumer-key",name:"providedConsumerKey",label:u.formatMessage({defaultMessage:"Consumer Key",id:"Shared.AppsAndKeys.ImportExternalApp.consumer.key"}),value:a,onChange:e=>h(e),margin:"normal",fullWidth:!0,disabled:!r,variant:"outlined"}),s.a.createElement(w.a,null,s.a.createElement(K.a,{id:"consumer-key-helper-text"},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ImportExternalApp.consumer.key.title",defaultMessage:"Consumer Key of the OAuth application"})))),s.a.createElement(x.a,{item:!0,xs:12},s.a.createElement(O.a,{id:"provided-consumer-secret",name:"providedConsumerSecret",label:u.formatMessage({defaultMessage:"Consumer Secret",id:"Shared.AppsAndKeys.ImportExternalApp.consumer.secret"}),value:t,onChange:e=>h(e),margin:"normal",fullWidth:!0,disabled:!r,variant:"outlined"}),s.a.createElement(w.a,null,s.a.createElement(K.a,{id:"consumer-secret-helper-text"},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ImportExternalApp.consumer.secret.of.application",defaultMessage:"Consumer Secret of the OAuth application"})))))),s.a.createElement(k.a,null,s.a.createElement(o.a,{onClick:y,color:"primary"},s.a.createElement(d.a,{defaultMessage:"Cancel",id:"Shared.AppsAndKeys.ImportExternalApp.cancel"})),s.a.createElement(v.a,{resourcePath:v.c.APPLICATION_GENERATE_KEYS,resourceMethod:v.b.POST},r?s.a.createElement(o.a,{variant:"contained",color:"primary",onClick:()=>l()},i?s.a.createElement(d.a,{defaultMessage:"Update",id:"Shared.AppsAndKeys.ImportExternalApp.provide.oauth.button.update"}):s.a.createElement(d.a,{defaultMessage:"Provide",id:"Shared.AppsAndKeys.ImportExternalApp.provide.oauth.button.provide"})):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{variant:"contained",color:"primary",onClick:()=>l(),disabled:!r},i?s.a.createElement(d.a,{defaultMessage:"Update",id:"Shared.AppsAndKeys.ImportExternalApp.provide. oauth.button.update"}):s.a.createElement(d.a,{defaultMessage:"Provide",id:"Shared.AppsAndKeys.ImportExternalApp.provide.oauth.button.provide"})),s.a.createElement(p.a,{variant:"caption"},s.a.createElement(d.a,{defaultMessage:"Only owner can provide keys",id:"Shared.AppsAndKeys.ImportExternalApp.key.provide.user.owner"})))))))}P.propTypes={intl:i.a.shape({}).isRequired,onChange:i.a.func.isRequired,consumerKey:i.a.string,consumerSecret:i.a.string,isUserOwner:i.a.string,key:i.a.shape({}).isRequired,provideOAuthKeySecret:i.a.func.isRequired,importDisabled:i.a.bool},P.defaultProps={consumerKey:"",consumerSecret:"",isUserOwner:!1,importDisabled:!1};var I=P,R=t(1279),N=t(48),D=t(1292),_=t(1421),q=t.n(_),j=t(352),U=t(283),L=t.n(U),G=t(1639),W=t(1527),B=t(1257),V=t.n(B),z=t(1664),F=t(1665),H=t(4991),J=t(1684),X=t(1685),Y=t(1686),$=t(1687),Q=t(25),Z=t.n(Q),ee=t(1273),ae=t(1552),te=t(2628),ne=t(1663),se=t(2631),re=t(1662),ie=t(1199),le=t(1794),oe=t(2212),ce=t(1814),pe=t.n(ce);const de=e=>{const{classes:a,config:t,isUserOwner:r,previousValue:i,handleChange:l}=e,[o,d]=Object(n.useState)(i),u=e=>{const{target:a}=e;d(a.value),l("additionalProperties",e)},m=Object(ie.a)({application_access_token_expiry_time:{id:"Shared.AppsAndKeys.AppConfiguration.application.access.token.expiry.time",defaultMessage:"Application Access Token Expiry Time"},user_access_token_expiry_time:{id:"Shared.AppsAndKeys.AppConfiguration.user.access.token.expiry.time",defaultMessage:"User Access Token Expiry Time"},refresh_token_expiry_time:{id:"Shared.AppsAndKeys.AppConfiguration.refresh.token.expiry.time",defaultMessage:"Refresh Token Expiry Time"},id_token_expiry_time:{id:"Shared.AppsAndKeys.AppConfiguration.id.token.expiry.time",defaultMessage:"Id Token Expiry Time"},pkceMandatory:{id:"Shared.AppsAndKeys.AppConfiguration.pkce.mandatory",defaultMessage:"Enable PKCE"},pkceSupportPlain:{id:"Shared.AppsAndKeys.AppConfiguration.pkce.support.plain",defaultMessage:"Support PKCE Plain text"},bypassClientCredentials:{id:"Shared.AppsAndKeys.AppConfiguration.bypass.client.credentials",defaultMessage:"Public client"}}),g=Object(ie.a)({application_access_token_expiry_time:{id:"Shared.AppsAndKeys.AppConfiguration.application.access.token.expiry.time.tooltip",defaultMessage:"Type Application Access Token Expiry Time"},user_access_token_expiry_time:{id:"Shared.AppsAndKeys.AppConfiguration.user.access.token.expiry.time.tooltip",defaultMessage:"Type User Access Token Expiry Time"},refresh_token_expiry_time:{id:"Shared.AppsAndKeys.AppConfiguration.refresh.token.expiry.time.tooltip",defaultMessage:"Type Refresh Token Expiry Time"},id_token_expiry_time:{id:"Shared.AppsAndKeys.AppConfiguration.id.token.expiry.time.tooltip",defaultMessage:"Type ID Token Expiry Time"},pkceMandatory:{id:"Shared.AppsAndKeys.AppConfiguration.pkce.mandatory.tooltip",defaultMessage:"Enable PKCE"},pkceSupportPlain:{id:"Shared.AppsAndKeys.AppConfiguration.pkce.support.plain.tooltip",defaultMessage:"S256 is recommended, plain text too can be used."},bypassClientCredentials:{id:"Shared.AppsAndKeys.AppConfiguration.bypass.client.credentials.tooltip",defaultMessage:"Allow authentication without the client secret."}}),y=()=>m[t.name]?e.intl.formatMessage(m[t.name]):t.label,h=()=>g[t.name]?e.intl.formatMessage(g[t.name]):t.tooltip;Object(n.useEffect)(()=>{d(i)},[i]);return s.a.createElement(s.a.Fragment,null,s.a.createElement($.a,null,s.a.createElement(Y.a,{component:"th",scope:"row",className:a.leftCol},y()),s.a.createElement(Y.a,null,s.a.createElement(c.a,{maxWidth:600},"select"===t.type&&!1===t.multiple?s.a.createElement(O.a,{classes:{root:a.removeHelperPadding},fullWidth:!0,id:t.name,select:!0,label:y(),value:o,name:t.name,onChange:e=>u(e),helperText:s.a.createElement(p.a,{variant:"caption"},h()),margin:"dense",variant:"outlined",disabled:!r},t.values.map(e=>s.a.createElement(re.a,{key:e,value:e},e))):"select"===t.type&&!0===t.multiple&&Array.isArray(o)?s.a.createElement(s.a.Fragment,null,s.a.createElement(w.a,{variant:"outlined",className:a.formControl,fullWidth:!0},s.a.createElement(te.a,{id:"multi-select-label"},t.label),s.a.createElement(le.a,{labelId:"multi-select-label",id:"multi-select-outlined",margin:"dense",displayEmpty:!0,name:t.name,multiple:!0,value:o,onChange:e=>u(e),input:s.a.createElement(oe.a,{id:"multi-select-outlined"}),renderValue:e=>s.a.createElement("div",{className:a.chips},e.map(e=>s.a.createElement(se.a,{key:e,label:e,className:a.chip}))),helperText:s.a.createElement(p.a,{variant:"caption"},h()),label:y()},t.values.map(e=>s.a.createElement(re.a,{key:e,value:e},s.a.createElement(G.a,{checked:o.indexOf(e)>-1}),s.a.createElement(ne.a,{primary:e}))))),s.a.createElement(p.a,{variant:"caption"},h())):"input"===t.type&&!0===t.multiple?s.a.createElement(s.a.Fragment,null,s.a.createElement(pe.a,{value:o,fullWidth:!0,variant:"outlined",id:"multi-input-outlined",label:t.label,onAdd:e=>{const a={target:{name:t.name,value:[...o,e]}};u(a)},chipRenderer:(e,a)=>{let{value:n}=e;return s.a.createElement(se.a,{key:a,size:"small",label:n,onDelete:()=>{const e={target:{name:t.name,value:o.filter(e=>e!==n)}};u(e)},style:{margin:"0 8px 12px 0",float:"left"}})},style:{display:"flex"}}),s.a.createElement(p.a,{variant:"caption"},t.tooltip)):"input"===t.type?s.a.createElement(O.a,{classes:{root:a.removeHelperPadding},fullWidth:!0,id:t.name,label:y(),value:o,name:t.name,onChange:e=>u(e),helperText:s.a.createElement(p.a,{variant:"caption"},h()),margin:"dense",variant:"outlined",disabled:!r}):"checkbox"===t.type?s.a.createElement(G.a,{classes:{root:a.removeHelperPadding},fullWidth:!0,id:t.name,label:y(),checked:"string"==typeof o&&"true"===o||"string"!=typeof o&&!0===o,name:t.name,onChange:e=>u(e),helperText:s.a.createElement(p.a,{variant:"caption"},h()),margin:"dense",variant:"outlined",disabled:!r}):s.a.createElement(O.a,{classes:{root:a.removeHelperPadding},fullWidth:!0,id:t.name,label:y(),value:o,name:t.name,onChange:e=>u(e),helperText:s.a.createElement(p.a,{variant:"caption"},h()),margin:"dense",variant:"outlined",disabled:!r})))))};de.defaultProps={notFound:!1},de.propTypes={classes:i.a.instanceOf(Object).isRequired,previousValue:i.a.any.isRequired,isUserOwner:i.a.bool.isRequired,handleChange:i.a.func.isRequired,config:i.a.any.isRequired,notFound:i.a.bool,intl:i.a.shape({formatMessage:i.a.func}).isRequired};var ue=Object(u.c)(Object(l.a)(e=>({FormControl:{paddingTop:e.spacing(2),paddingBottom:e.spacing(2),paddingLeft:0,width:"100%"},FormControlOdd:{padding:e.spacing(2),width:"100%"},button:{marginLeft:e.spacing(1)},quotaHelp:{position:"relative"},checkboxWrapper:{display:"flex"},checkboxWrapperColumn:{display:"flex",flexDirection:"row"},group:{flexDirection:"row"},removeHelperPadding:{"& p":{margin:"8px 0px"}}}))(de));const me=e=>{const[a,t]=Object(n.useState)(!1),[r,i]=Object(n.useState)(!1),l=Object(M.a)(),{classes:o,notFound:p,isUserOwner:u,keyManagerConfig:m,updateKeyRequest:g,keyRequest:y,updateHasError:h,callbackError:b,mode:E}=e,{selectedGrantTypes:f,callbackUrl:k}=y,{applicationConfiguration:A,availableGrantTypes:T,description:S,additionalProperties:C,enableMapOAuthConsumerApps:v,enableOAuthAppCreation:w,enableTokenEncryption:x,enableTokenGeneration:P,id:I,name:R,revokeEndpoint:N,tokenEndpoint:D,type:_,userInfoEndpoint:q}=m,j=(e,a)=>{const t=L()(y),{target:n}=a;let s=[...t.selectedGrantTypes];switch(t.keyManager=R,e){case"callbackUrl":(s.includes("implicit")||s.includes("authorization_code"))&&(""===n.value?(h(!0),i(l.formatMessage({defaultMessage:"Call back URL can not be empty when Implicit or Authorization Code grants are selected.",id:"Shared.AppsAndKeys.KeyConfCiguration.Invalid.callback.empty.error.text"}))):ae.a.url.validate(k).error?(h(!0),i(l.formatMessage({defaultMessage:"Invalid URL. Please enter a valid URL.",id:"Shared.AppsAndKeys.KeyConfCiguration.Invalid.callback.url.error.text"}))):(i(!1),h(!1))),t.callbackUrl=n.value;break;case"grantType":n.checked?s=[...s,n.id]:(s=t.selectedGrantTypes.filter(e=>e!==n.id),"implicit"!==n.id&&"authorization_code"!==n.id||(t.callbackUrl="",i(!1),h(!1))),t.selectedGrantTypes=s;break;case"additionalProperties":const e=t.additionalProperties;"checkbox"===n.type?e[n.name]=n.checked+"":e[n.name]=n.value,t.additionalProperties=e}g(t)},U=()=>{t(!0);setTimeout((function(){t(!1)}),2e3)},B=e=>{const{additionalProperties:a}=y;let t;t="input"!=e.type||e.multiple?!(!a||!a[e.name]):!(!a||!a[e.name]&&""!==a[e.name]);let n=e.default;return e.multiple&&"string"==typeof n&&""===n&&(n=[]),t?a[e.name]:n};if(p)return s.a.createElement(ee.a,null);const Q=((e,a)=>{const t={};return e.forEach(e=>{t[e]=a[e],a[e]||(t[e]=e)}),t})(T,Z.a.grantTypes);return s.a.createElement(s.a.Fragment,null,s.a.createElement(c.a,{display:"flex",alignItems:"center"},s.a.createElement(J.a,{className:o.table},s.a.createElement(X.a,null,D&&""!==D&&s.a.createElement($.a,null,s.a.createElement(Y.a,{component:"th",scope:"row",className:o.leftCol},s.a.createElement(d.a,{defaultMessage:"Token Endpoint",id:"Shared.AppsAndKeys.KeyConfiguration.token.endpoint.label"})),s.a.createElement(Y.a,null,D,s.a.createElement(z.a,{title:a?l.formatMessage({defaultMessage:"Copied",id:"Shared.AppsAndKeys.KeyConfiguration.copied"}):l.formatMessage({defaultMessage:"Copy to clipboard",id:"Shared.AppsAndKeys.KeyConfiguration.copy.to.clipboard"}),placement:"right",className:o.iconStyle},s.a.createElement(V.a,{text:D,onCopy:U},s.a.createElement(F.a,{"aria-label":"Copy to clipboard",classes:{root:o.iconButton}},s.a.createElement(H.a,{color:"secondary"},"file_copy")))))),N&&""!==N&&s.a.createElement($.a,null,s.a.createElement(Y.a,{component:"th",scope:"row",className:o.leftCol},s.a.createElement(d.a,{defaultMessage:"Revoke Endpoint",id:"Shared.AppsAndKeys.KeyConfiguration.revoke.endpoint.label"})),s.a.createElement(Y.a,null,N,s.a.createElement(z.a,{title:a?l.formatMessage({defaultMessage:"Copied",id:"Shared.AppsAndKeys.KeyConfiguration.copied"}):l.formatMessage({defaultMessage:"Copy to clipboard",id:"Shared.AppsAndKeys.KeyConfiguration.copy.to.clipboard"}),placement:"right",className:o.iconStyle},s.a.createElement(V.a,{text:N,onCopy:U},s.a.createElement(F.a,{"aria-label":"Copy to clipboard",classes:{root:o.iconButton}},s.a.createElement(H.a,{color:"secondary"},"file_copy")))))),q&&""!==q&&s.a.createElement($.a,null,s.a.createElement(Y.a,{component:"th",scope:"row",className:o.leftCol},s.a.createElement(d.a,{defaultMessage:"User Info Endpoint",id:"Shared.AppsAndKeys.KeyConfiguration.userinfo.endpoint.label"})),s.a.createElement(Y.a,null,q,s.a.createElement(z.a,{title:a?l.formatMessage({defaultMessage:"Copied",id:"Shared.AppsAndKeys.KeyConfiguration.copied"}):l.formatMessage({defaultMessage:"Copy to clipboard",id:"Shared.AppsAndKeys.KeyConfiguration.copy.to.clipboard"}),placement:"right",className:o.iconStyle},s.a.createElement(V.a,{text:q,onCopy:U},s.a.createElement(F.a,{"aria-label":"Copy to clipboard",classes:{root:o.iconButton}},s.a.createElement(H.a,{color:"secondary"},"file_copy")))))),"MAPPED"!==E&&s.a.createElement(s.a.Fragment,null,s.a.createElement($.a,null,s.a.createElement(Y.a,{component:"th",scope:"row",className:o.leftCol},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.KeyConfiguration.grant.types",defaultMessage:"Grant Types"})),s.a.createElement(Y.a,null,s.a.createElement("div",{className:o.checkboxWrapperColumn,id:"grant-types"},Object.keys(Q).map(e=>{const a=Q[e];return s.a.createElement(W.a,{control:s.a.createElement(G.a,{id:e,checked:!(!f||!f.includes(e)),onChange:e=>j("grantType",e),value:a,disabled:!u,color:"primary","data-testid":e}),label:a,key:e})})),s.a.createElement(K.a,null,s.a.createElement(d.a,{defaultMessage:"The application can use the following grant types to generate \n                            Access Tokens. Based on the application requirement,you can enable or disable \n                            grant types for this application.",id:"Shared.AppsAndKeys.KeyConfiguration.the.application.can"})))),s.a.createElement($.a,null,s.a.createElement(Y.a,{component:"th",scope:"row",className:o.leftCol},s.a.createElement(d.a,{defaultMessage:"Callback URL",id:"Shared.AppsAndKeys.KeyConfiguration.callback.url.label"})),s.a.createElement(Y.a,null,s.a.createElement(c.a,{maxWidth:600},s.a.createElement(O.a,{margin:"dense",id:"callbackURL",label:s.a.createElement(d.a,{defaultMessage:"Callback URL",id:"Shared.AppsAndKeys.KeyConfiguration.callback.url.label"}),value:k,name:"callbackURL",onChange:e=>j("callbackUrl",e),helperText:r||s.a.createElement(d.a,{defaultMessage:"Callback URL is a redirection URI in the client\n                            application which is used by the authorization server to send the\n                            client's user-agent (usually web browser) back after granting access.",id:"Shared.AppsAndKeys.KeyConfCiguration.callback.url.helper.text"}),variant:"outlined",disabled:!u||f&&!f.includes("authorization_code")&&!f.includes("implicit"),error:b,placeholder:l.formatMessage({defaultMessage:"http://url-to-webapp",id:"Shared.AppsAndKeys.KeyConfiguration.url.to.webapp"}),fullWidth:!0})))),A.length>0&&A.map(e=>s.a.createElement(ue,{config:e,previousValue:B(e),isUserOwner:u,handleChange:j})))))))};me.defaultProps={notFound:!1,validating:!1,mode:null},me.propTypes={classes:i.a.instanceOf(Object).isRequired,keyRequest:i.a.shape({callbackUrl:i.a.string,selectedGrantTypes:i.a.array}).isRequired,isUserOwner:i.a.bool.isRequired,isKeysAvailable:i.a.bool.isRequired,keyManagerConfig:i.a.any.isRequired,notFound:i.a.bool,setGenerateEnabled:i.a.func.isRequired,updateKeyRequest:i.a.func.isRequired,validating:i.a.bool,mode:i.a.string};var ge=Object(l.a)(e=>({FormControl:{paddingTop:0,paddingBottom:e.spacing(2),paddingLeft:0,width:"100%"},FormControlOdd:{padding:e.spacing(2),width:"100%"},button:{marginLeft:e.spacing(1)},quotaHelp:{position:"relative"},checkboxWrapper:{display:"flex"},checkboxWrapperColumn:{display:"flex",flexWrap:"wrap",flexDirection:"row",whiteSpace:"nowrap"},group:{flexDirection:"row"},removeHelperPadding:{"& p":{margin:"8px 0px"}},iconStyle:{cursor:"pointer",padding:"0 0 0 10px"},iconButton:{padding:"0 0 0 10px","& .material-icons":{fontSize:16}},titleColumn:{width:150,fontWeight:500},keyInfoTable:{marginBottom:20,borderCollapse:"collapse","& td":{paddingBottom:5,borderBottom:"solid 1px #cccc"}},leftCol:{width:180}}))(me),ye=t(4974),he=t(1923),be=t(1469),Ee=t(1420),fe=t(1551),ke=t(1666),Ae=t(1369),Te=t.n(Ae);const Se=Object(ke.a)(e=>({code:{padding:e.spacing(1),marginBottom:e.spacing(2),background:e.palette.grey[200],color:"#da2316",flex:1},command:{color:"#2b62b0"},encodeVisible:{cursor:"pointer",textDecoration:"underline"},contentWrapper:{display:"flex"}}));function Ce(e){const a=Se(),{keys:{consumerKey:t,consumerSecret:r},intl:i,keyManagerConfig:l,jwtToken:o,defaultTokenEndpoint:c}=e,u=window.btoa(t+":"+r),[m,g]=Object(n.useState)(!1),[y,h]=Object(n.useState)(!1),b=()=>{h(!0);setTimeout((function(){h(!1)}),4e3)},E=()=>{g(!m)};let{tokenEndpoint:f}=l;return null===l.alias?s.a.createElement(s.a.Fragment,null,s.a.createElement(p.a,null,s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewCurl.help",defaultMessage:"The following cURL command shows how to generate an access token using the Password Grant type."})),s.a.createElement("div",{className:a.contentWrapper},s.a.createElement("div",{className:a.code},s.a.createElement("div",null,s.a.createElement("span",{className:a.command},"curl -k -X POST ")," ",f,s.a.createElement("span",{className:a.command}," -d ")," ",'"grant_type=password&username=Username&password=Password"'),s.a.createElement("div",null,s.a.createElement("span",{className:a.command}," -H "),'"Authorization: Basic',s.a.createElement("a",{onClick:E,className:a.encodeVisible},m?" "+u:" Base64(consumer-key:consumer-secret)"),'"')),s.a.createElement("div",null,s.a.createElement(z.a,{title:y?i.formatMessage({defaultMessage:"Copied",id:"Shared.AppsAndKeys.ViewCurl.copied"}):i.formatMessage({defaultMessage:"Copy to clipboard",id:"Shared.AppsAndKeys.ViewCurl.copy.to.clipboard"}),placement:"right"},s.a.createElement(V.a,{text:`curl -k -X POST ${f} -d "grant_type=password&username=Username&password=Password" -H "Authorization: Basic ${u}"`,onCopy:b},s.a.createElement(Te.a,{color:"secondary"}))))),s.a.createElement(p.a,null,s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewCurl.help.in.a.similar",defaultMessage:"In a similar manner, you can generate an access token using the\n                    Client Credentials grant type with the following cURL command."})),s.a.createElement("div",{className:a.contentWrapper},s.a.createElement("div",{className:a.code},s.a.createElement("div",null,s.a.createElement("span",{className:a.command},"curl -k -X POST ")," ",f,s.a.createElement("span",{className:a.command}," -d ")," ",'"grant_type=client_credentials"'),s.a.createElement("div",null,s.a.createElement("span",{className:a.command}," -H "),'"Authorization: Basic',s.a.createElement("a",{onClick:E,className:a.encodeVisible},m?" "+u:" Base64(consumer-key:consumer-secret)"),'"')),s.a.createElement("div",null,s.a.createElement(z.a,{title:y?i.formatMessage({defaultMessage:"Copied",id:"Shared.AppsAndKeys.ViewCurl.copied"}):i.formatMessage({defaultMessage:"Copy to clipboard",id:"Shared.AppsAndKeys.ViewCurl.copy.to.clipboard"}),placement:"right"},s.a.createElement(V.a,{text:`curl -k -X POST ${f} -d "grant_type=client_credentials" -H "Authorization: Basic ${u}"`,onCopy:b},s.a.createElement(Te.a,{color:"secondary"})))))):!1===t?s.a.createElement(p.a,null,s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewCurl.error",defaultMessage:"Please generate the Consumer Key and Secret for Residence Key Manager with selecting the urn:ietf:params:oauth:grant-type:token-exchange grant type in order to use the token Exchange Approach. "})):s.a.createElement(s.a.Fragment,null,s.a.createElement(p.a,null,s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewCurl.TokenExchange.help",defaultMessage:"The following cURL command shows how to generate an access token using the token exchange grant type"})),s.a.createElement("div",{className:a.contentWrapper},s.a.createElement("div",{className:a.code},s.a.createElement("div",null,s.a.createElement("span",{className:a.command},"curl -k -X POST ")," ",c,s.a.createElement("span",{className:a.command}," -d ")," ",'"grant_type=urn:ietf:params:oauth:grant-type:token-exchange"',s.a.createElement("span",{className:a.command}," -d ")," ",'"subject_token_type=urn:ietf:params:oauth:token-type:jwt"',s.a.createElement("span",{className:a.command}," -d ")," ",'"requested_token_type=urn:ietf:params:oauth:token-type:jwt" ',s.a.createElement("span",{className:a.command}," -d ")," ",'"subject_token="',s.a.createElement("a",{onClick:E,className:a.encodeVisible},m?" "+o:"jwtToken")),s.a.createElement("div",null,s.a.createElement("span",{className:a.command}," -H "),'"Authorization: Basic',s.a.createElement("a",{onClick:E,className:a.encodeVisible},m?" "+u:" Base64(consumer-key:consumer-secret)"),'"')),s.a.createElement("div",null,s.a.createElement(z.a,{title:y?i.formatMessage({defaultMessage:"Copied",id:"Shared.AppsAndKeys.ViewCurl.copied"}):i.formatMessage({defaultMessage:"Copy to clipboard",id:"Shared.AppsAndKeys.ViewCurl.copy.to.clipboard"}),placement:"right"},s.a.createElement(V.a,{text:`curl -k -X POST ${c} -d "grant_type=urn:ietf:params:oauth:grant-type:token-exchange" -d "subject_token_type=urn:ietf:params:oauth:token-type:jwt" -d "requested_token_type=urn:ietf:params:oauth:token-type:jwt" -d "subject_token=${o}"  -H "Authorization: Basic ${u}"`,onCopy:b},s.a.createElement(Te.a,{color:"secondary"}))))))}Ce.propTypes={classes:i.a.shape({}).isRequired,keys:i.a.shape({}).isRequired,apis:i.a.shape({}).isRequired,jwtToken:i.a.string,defaultTokenEndpoint:i.a.string};var ve=Object(u.c)(Ce);function Me(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function Ke(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?Me(Object(t),!0).forEach((function(a){we(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Me(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function we(e,a,t){return(a=function(e){var a=function(e,a){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(e,"string");return"symbol"==typeof a?a:String(a)}(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class xe extends s.a.Component{constructor(e){super(e),we(this,"updateAccessTokenRequest",e=>{this.setState({accessTokenRequest:e})}),we(this,"onCopy",e=>{this.setState({[e]:!0});const a=this,t=e;setTimeout(()=>{a.setState({[t]:!1})},4e3)}),we(this,"handleShowHidden",e=>{this.setState({[e]:!this.state[e]})}),we(this,"handleMouseDownGeneric",e=>{e.preventDefault()}),we(this,"handleClickOpen",()=>{this.setState({open:!0,showToken:!1})}),we(this,"handleSecretRegenerate",(e,a,t,n)=>{this.applicationPromise.then(s=>s.regenerateSecret(e,a,t,n)).then(e=>{console.log("consumer secret regenerated successfully "+e),this.setState({open:!0,showSecretGen:!0,secretGenResponse:e})}).catch(e=>{const{status:a}=e;404===a&&this.setState({notFound:!0})})}),we(this,"handleClickOpenCurl",()=>{this.setState({open:!0,showCurl:!0})}),we(this,"handleClose",()=>{this.setState({open:!1,showCurl:!1,isKeyJWT:!1,showSecretGen:!1})}),we(this,"generateAccessToken",()=>{const{accessTokenRequest:e,isUpdating:a}=this.state,{selectedTab:t,intl:n}=this.props;this.setState({isUpdating:!0}),this.applicationPromise.then(a=>a.generateToken(t,e.keyType,e.timeout,e.scopesSelected)).then(e=>{console.log("token generated successfully "+e),this.setState({showToken:!0,tokenResponse:e,token:e.accessToken,tokenScopes:e.tokenScopes,tokenValidityTime:e.validityTime}),this.setState({isUpdating:!1})}).catch(e=>{const{status:a}=e;404===a?this.setState({notFound:!0}):400===a&&E.a.error(e.description||n.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.generate.bad.request.error",defaultMessage:"Error occurred when generating Access Token"})),this.setState({isUpdating:!1});const{response:t}=e;t&&t.body&&E.a.error(t.body.message)})}),we(this,"viewKeyAndSecret",(e,a,t,n,r)=>{const{classes:i,intl:l,selectedApp:{hashEnabled:c},keyType:p}=this.props,{keyCopied:u,secretCopied:m,showCS:g}=this.state;return s.a.createElement(s.a.Fragment,null,s.a.createElement(x.a,{item:!0,xs:6},s.a.createElement("div",{className:i.copyWrapper},s.a.createElement(O.a,{id:"consumer-key",value:e,margin:"dense",label:s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewKeys.consumer.key",defaultMessage:"Consumer Key"}),fullWidth:!0,variant:"outlined",InputProps:{readOnly:!0,endAdornment:s.a.createElement(ye.a,{position:"end"},s.a.createElement(z.a,{title:u?l.formatMessage({defaultMessage:"Copied",id:"Shared.AppsAndKeys.ViewKeys.copied"}):l.formatMessage({defaultMessage:"Copy to clipboard",id:"Shared.AppsAndKeys.ViewKeys.copy.to"}),placement:"right"},s.a.createElement(V.a,{text:e,onCopy:()=>this.onCopy("keyCopied"),classes:{root:i.iconButton}},s.a.createElement(F.a,{"aria-label":"Copy to clipboard",classes:{root:i.iconButton}},s.a.createElement(H.a,{color:"secondary"},"file_copy")))))}})),s.a.createElement(w.a,null,s.a.createElement(K.a,{id:"consumer-key-helper-text"},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewKeys.consumer.key.title",defaultMessage:"Consumer Key of the application"})))),s.a.createElement(x.a,{item:!0,xs:6},s.a.createElement("div",{className:i.copyWrapper},c?s.a.createElement(o.a,{variant:"contained",color:"primary",className:i.button,onClick:()=>this.handleSecretRegenerate(e,p,t,n),disabled:!r},s.a.createElement(d.a,{defaultMessage:"Regenerate Consumer Secret",id:"Shared.AppsAndKeys.ViewKeys.consumer.secret.button.regenerate"})):s.a.createElement(O.a,{id:"consumer-secret",label:s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewKeys.consumer.secret",defaultMessage:"Consumer Secret"}),type:g||!a?"text":"password",value:a,margin:"dense",fullWidth:!0,variant:"outlined",InputProps:{readOnly:!0,endAdornment:s.a.createElement(ye.a,{position:"end"},s.a.createElement(F.a,{classes:{root:i.iconButton},onClick:()=>this.handleShowHidden("showCS"),onMouseDown:this.handleMouseDownGeneric,id:"visibility-toggle-btn"},g?s.a.createElement(H.a,null,"visibility_off"):s.a.createElement(H.a,null,"visibility")),s.a.createElement(z.a,{title:m?l.formatMessage({defaultMessage:"Copied",id:"Shared.AppsAndKeys.ViewKeys.copied"}):l.formatMessage({defaultMessage:"Copy to clipboard",id:"Shared.AppsAndKeys.ViewKeys.copy.to.clipboard"}),placement:"right"},s.a.createElement(V.a,{text:a,onCopy:()=>this.onCopy("secretCopied"),classes:{root:i.iconButton}},s.a.createElement(F.a,{"aria-label":"Copy to clipboard",classes:{root:i.iconButton}},s.a.createElement(H.a,{color:"secondary"},"file_copy")))))}})),!c&&s.a.createElement(w.a,null,s.a.createElement(K.a,{id:"consumer-secret-helper-text"},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewKeys.consumer.secret.of.application",defaultMessage:"Consumer Secret of the application"})))))});const{selectedApp:a}=this.props;let t;a&&(t=a.appId||a.value),this.applicationPromise=R.a.get(t),this.state={showCS:!1,open:!1,showToken:!1,showCurl:!1,showSecretGen:!1,accessTokenRequest:{timeout:3600,scopesSelected:[],keyType:""},subscriptionScopes:[],isUpdating:!1}}componentDidMount(){const{accessTokenRequest:e}=this.state,{keyType:a}=this.props;this.applicationPromise.then(t=>{t.getKeys().then(()=>{const n=Ke(Ke({},e),{},{keyType:a}),s=t.subscriptionScopes.map(e=>e.key);this.setState({accessTokenRequest:n,subscriptionScopes:s})})}).catch(e=>{const{status:a}=e;404===a&&this.setState({notFound:!0})})}componentDidUpdate(e){const{isKeyJWT:a}=this.props;a&&!e.isKeyJWT&&this.setState({isKeyJWT:!0})}render(){const{notFound:e,showToken:a,showCurl:t,showSecretGen:n,tokenCopied:r,open:i,token:l,tokenScopes:c,tokenValidityTime:u,accessTokenRequest:y,subscriptionScopes:h,isKeyJWT:b,tokenResponse:E,secretGenResponse:S,isUpdating:C}=this.state,{intl:v,keyType:M,classes:K,fullScreen:w,keys:O,selectedApp:{tokenType:P},selectedGrantTypes:I,isUserOwner:R,summary:N,selectedTab:D,hashEnabled:_,keyManagerConfig:q,initialToken:j,initialValidityTime:U,initialScopes:L,mode:G}=this.props;if(e)return s.a.createElement(ee.a,null);if(!O)return s.a.createElement(m.a,null);const W=O.size>0&&O.get(D)&&O.get(D).keyType===M&&O.get(D),B=W&&W.consumerKey,V=W&&W.consumerSecret,z=W&&W.keyMappingId;let F,H,J,X,Y;if(l?(F=l,H=c,J=u):O.get(D)&&O.get(D).keyType===M&&O.get(D).token&&(({accessToken:F}=O.get(D).token),H=O.get(D).token.tokenScopes,J=O.get(D).token.validityTime,X=O.get(D).token,X&&!X.accessToken&&(X.accessToken=j,X.validityTime=U,X.tokenScopes=L)),Y=t?"Get CURL to Generate Access Token":n?"Generate Consumer Secret":"Generate Access Token",!B)return s.a.createElement(p.a,{variant:"caption",gutterBottom:!0},"PRODUCTION"===M?"Production ":"Sandbox ",s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewKeys.key.secret.title",defaultMessage:"Key and Secret is not generated for this application"}));if(N)return s.a.createElement(x.a,{container:!0,spacing:3},this.viewKeyAndSecret(B,V,z,D,R));const{supportedGrantTypes:$}=O.get(D);return B&&s.a.createElement("div",{className:K.inputWrapper},s.a.createElement(x.a,{container:!0,spacing:3},this.viewKeyAndSecret(B,V,z,D,R),s.a.createElement(x.a,{item:!0,xs:12},s.a.createElement(f.a,{fullScreen:w,open:i||b&&X,onClose:this.handleClose,"aria-labelledby":"responsive-dialog-title",className:K.dialogWrapper},s.a.createElement(T.a,{id:"responsive-dialog-title"},Y),s.a.createElement(A.a,null,!t&&!b&&!n&&s.a.createElement(he.a,null,!a&&s.a.createElement(be.a,{updateAccessTokenRequest:this.updateAccessTokenRequest,accessTokenRequest:y,subscriptionScopes:h}),a&&s.a.createElement(Ee.a,{token:Ke(Ke({},E),{},{isOauth:!0})})),t&&s.a.createElement(he.a,null,s.a.createElement(ve,{keys:{consumerKey:B,consumerSecret:V},keyType:M,keyManagerConfig:q})),n&&s.a.createElement(he.a,null,s.a.createElement(fe.a,{secret:Ke({},S)})),b&&X&&_&&s.a.createElement(he.a,null,s.a.createElement(Ee.a,{token:Ke(Ke({},X),{},{isOauth:!0}),consumerSecret:V})),b&&X&&!_&&s.a.createElement(he.a,null,s.a.createElement(Ee.a,{token:Ke(Ke({},X),{},{isOauth:!0})}))),s.a.createElement(k.a,null,C&&s.a.createElement(g.a,{size:24}),!a&&!t&&!b&&!n&&s.a.createElement(o.a,{onClick:this.generateAccessToken,color:"primary",id:"generate-access-token-generate-btn",disabled:C},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewKeys.consumer.generate.btn",defaultMessage:"Generate"})),s.a.createElement(o.a,{onClick:this.handleClose,id:"generate-access-token-close-btn",color:"primary",autoFocus:!0},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewKeys.consumer.close.btn",defaultMessage:"Close"})))),!_&&s.a.createElement("div",{className:K.tokenSection},q.enableTokenGeneration&&$&&$.find(e=>e.includes("client_credentials"))&&"MAPPED"!==G&&s.a.createElement(o.a,{id:"generate-access-token-oauth2",variant:"outlined",size:"small",color:"primary",className:K.margin,onClick:this.handleClickOpen,disabled:!$.includes("client_credentials")},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewKeys.generate.access.token",defaultMessage:"Generate Access Token"})),s.a.createElement(o.a,{id:"curl-to-generate-access-token-btn",variant:"outlined",size:"small",color:"primary",className:K.margin,onClick:this.handleClickOpenCurl},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewKeys.curl.to.generate",defaultMessage:"CURL to Generate Access Token"}))),$&&!$.includes("client_credentials")&&!_&&s.a.createElement(p.a,{variant:"caption",gutterBottom:!0},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewKeys.client.enable.client.credentials",defaultMessage:"Enable Client Credentials grant type to generate test access tokens"})))))}}xe.defaultProps={fullScreen:!1,summary:!1,mode:null},xe.propTypes={classes:i.a.shape({}).isRequired,fullScreen:i.a.bool,isKeyJWT:i.a.bool.isRequired,isUserOwner:i.a.bool.isRequired,summary:i.a.bool,mode:i.a.string};var Oe=Object(u.c)(Object(l.a)(e=>({button:{margin:e.spacing(3),color:e.palette.getContrastText(e.palette.background.default),display:"flex",alignItems:"center",fontSize:"11px",cursor:"pointer","& span":{paddingLeft:6,display:"inline-block"}},inputWrapper:{display:"flex",flexDirection:"row",alignItems:"center","& span, & h5, & label, & td, & li, & div, & input":{color:e.palette.getContrastText(e.palette.background.paper)}},copyWrapper:{display:"flex",flexDirection:"row",alignItems:"center"},tokenSection:{marginTop:0,marginBottom:e.spacing(.5)},margin:{marginRight:e.spacing(2)},dialogWrapper:{"& label,& h5, & label, & td, & li, & input, & h2, & p.MuiTypography-root,& p.MuiFormHelperText-root":{color:e.palette.getContrastText(e.palette.background.paper)}},iconButton:{padding:"0 0 0 10px","& .material-icons":{fontSize:16}}}))(xe));var Pe=Object(u.c)(Object(l.a)(e=>({root:{padding:e.spacing(3)}}))(e=>{const{classes:a,keyState:t,states:n,intl:r}=e;let i=r.formatMessage({defaultMessage:"A request to register this application has been sent and is pending approval.",id:"Shared.AppsAndKeys.WaitingForApproval.msg.ok"});return t===n.REJECTED&&(i=r.formatMessage({defaultMessage:"This application has been rejected from generating keys",id:"Shared.AppsAndKeys.WaitingForApproval.msg.reject"})),s.a.createElement("div",{className:a.root},i)}));const Ie=Object(ke.a)(e=>({root:{padding:e.spacing(3,2)}}));function Re(e){const a=Ie(),{keys:t,keyStates:n,key:r,selectedApp:i,keyType:l,isKeyJWT:o,isUserOwner:c,selectedTab:u}=e;if(t.size>0&&r&&"APPROVED"===r.keyState&&!r.consumerKey)return s.a.createElement("div",{className:a.emptyBox},s.a.createElement(p.a,{variant:"h5",component:"h3"},"Error"),s.a.createElement(p.a,{variant:"body2"},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.TokenManagerSummary",defaultMessage:"Error! You have partially-created keys. Use `Clean Up` option."})));if(r&&(r.keyState===n.CREATED||r.keyState===n.REJECTED))return s.a.createElement("div",{className:a.emptyBox},s.a.createElement(p.a,{variant:"body2"},s.a.createElement(Pe,{keyState:r.keyState,states:n})));const m=r?r.supportedGrantTypes:[];return s.a.createElement(Oe,{selectedApp:i,selectedTab:u,keyType:l,keys:t,isKeyJWT:o,selectedGrantTypes:m,isUserOwner:c,summary:!0})}var Ne=t(210);function De(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function _e(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?De(Object(t),!0).forEach((function(a){qe(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):De(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function qe(e,a,t){return(a=function(e){var a=function(e,a){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(e,"string");return"symbol"==typeof a?a:String(a)}(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function je(e,a){const{field:t,value:n}=a;switch(t){case"tokenResponse":case"token":case"tokenScopes":case"tokenValidityTime":case"accessTokenRequest":case"subscriptionScopes":case"externalIDPToken":case"externalIDPTokenError":case"isKeyJWT":case"initialExecution":return _e(_e({},e),{},{[t]:n});case"all":return n;default:return a}}const Ue=e=>{const[a,t]=Object(n.useState)(!1),[r,i]=Object(n.useState)(!1),[l,u]=Object(n.useState)(!1),[y,h]=Object(n.useState)(!1),[b,S]=Object(n.useState)(!1),[C,v]=Object(n.useState)(!1),[K,w]=Object(n.useState)(!1),[P,I]=Object(n.useState)(!1),[N,D]=Object(n.useState)(!0),[_]=Object(n.useState)({tokenResponse:"",token:"",tokenScope:"",tokenValidityTime:"",accessTokenRequest:{timeout:3600,scopesSelected:[],keyType:""},subscriptionScopes:[],externalIDPToken:"",externalIDPTokenError:"",isKeyJWT:!1,initialExecution:!0}),[q,j]=Object(n.useReducer)(je,_),{tokenResponse:U,accessTokenRequest:L,externalIDPToken:G,externalIDPTokenError:W,subscriptionScopes:B,tokenValidityTime:Q,token:Z,isKeyJWT:ae,initialExecution:te}=q,ne=Object(M.a)(),{classes:se,keyManagerConfig:re,defaultTokenEndpoint:ie,selectedApp:le,selectedTab:oe,selectedApp:{hashEnabled:ce},keys:pe,fullScreen:de,keyType:ue}=e;let me;le&&(me=le.appId||le.value);const ge=R.a.get(me);te&&ge.then(e=>{e.getKeys().then(()=>{const a=_e(_e({},L),{},{keyType:ue}),t=e.subscriptionScopes.map(e=>e.key);j({field:"accessTokenRequest",value:a}),j({field:"subscriptionScopes",value:t}),j({field:"initialExecution",value:!1})})}).catch(e=>{const{status:a}=e;404===a&&w(!0),j({field:"initialExecution",value:!1})});let ye;ye=b?"Get CURL to Generate Access Token":C?"Generate Consumer Secret":"Generate Access Token";const fe=e=>""===e?s.a.createElement(d.a,{id:"application.productionKeys.oAuth.externalIdp.tokenGeneration.token.empty.helperText",defaultMessage:"{selectedIdPType} token cannot be empty",values:{selectedIdPType:re.type}}):"";if(K)return s.a.createElement(ee.a,null);if(!pe)return s.a.createElement(m.a,null);const ke=()=>{u(!1),S(!1),v(!1),j({field:"isKeyJWT",value:!1})},Ae=pe.size>0&&pe.get("Resident Key Manager")&&pe.get("Resident Key Manager").keyType===ue&&pe.get("Resident Key Manager")||!1,Te=Ae&&Ae.consumerKey,Se=Ae&&Ae.consumerSecret;return s.a.createElement(s.a.Fragment,null,s.a.createElement(c.a,{display:"flex",alignItems:"center"},s.a.createElement(J.a,{className:se.table},s.a.createElement(X.a,null,s.a.createElement($.a,null,s.a.createElement(Y.a,{component:"th",scope:"row",className:[se.leftCol,se.tableHeader]},s.a.createElement(d.a,{id:"application.productionKeys.oAuth.externalIdp.tokenGeneration.step1",defaultMessage:"Step 1:"})),s.a.createElement(Y.a,{className:se.tableHeader},s.a.createElement(d.a,{id:"application.productionKeys.oAuth.externalIdp.tokenGeneration.step1.description",defaultMessage:"Obtain an access token from {selectedIdpType}. ",values:{selectedIdpType:re.type}}),s.a.createElement(d.a,{id:"application.productionKeys.oAuth.externalIdp.tokenGeneration.audience",defaultMessage:'Use the audience value "{allowedAudience}", ',values:{allowedAudience:s.a.createElement("b",null,re.alias)}}))),s.a.createElement($.a,null,s.a.createElement(Y.a,{className:se.leftCol},s.a.createElement(d.a,{id:"application.productionKeys.oAuth.tokenEndpoint",defaultMessage:"Token Endpoint"})),s.a.createElement(Y.a,null,s.a.createElement(d.a,{id:"application.productionKeys.oAuth.tokenEndpoint.value",defaultMessage:"{tokenEndpoint}",values:{tokenEndpoint:re.tokenEndpoint}}),s.a.createElement(z.a,{title:a?ne.formatMessage({defaultMessage:"Copied",id:"Shared.AppsAndKeys.TokenExchangeKeyConfiguration.copied"}):ne.formatMessage({defaultMessage:"Copy to clipboard",id:"Shared.AppsAndKeys.TokenExchangeKeyConfiguration.copy.to.clipboard"}),placement:"right",className:se.iconStyle},s.a.createElement(V.a,{text:re.tokenEndpoint,onCopy:()=>{t(!0);setTimeout((function(){t(!1)}),2e3)}},s.a.createElement(F.a,{"aria-label":"Copy to clipboard",classes:{root:se.iconButton}},s.a.createElement(H.a,{color:"secondary"},"file_copy")))))),s.a.createElement($.a,null,s.a.createElement(Y.a,{component:"th",scope:"row",className:[se.leftCol,se.tableHeader]},s.a.createElement(d.a,{id:"application.productionKeys.oAuth.tokenGeneration.step2",defaultMessage:"Step 2:"})),s.a.createElement(Y.a,{className:se.tableHeader},s.a.createElement(d.a,{id:"application.productionKeys.oAuth.tokenGeneration.step2.description",defaultMessage:"Obtain test token"}))),s.a.createElement($.a,null,s.a.createElement(Y.a,{component:"th",scope:"row",className:se.leftCol},s.a.createElement(d.a,{id:"application.productionKeys.oAuth.externalIdp.tokenGeneration.token",defaultMessage:"{selectedIdpType} Token",values:{selectedIdpType:re.type}}),s.a.createElement("span",{className:se.error}," *")),s.a.createElement(Y.a,null,s.a.createElement(c.a,{maxWidth:600},s.a.createElement(O.a,{id:"external-idp-token",onChange:e=>{const a=e.target.value;j({field:"externalIDPTokenError",value:fe(a)}),j({field:"externalIDPToken",value:a})},size:"small",fullWidth:!0,rows:1,value:G,variant:"outlined",error:""!==W,FormHelperTextProps:{className:se.helperText},helperText:""===W?W:s.a.createElement("div",{className:se.helperTextError},s.a.createElement("p",null," ",W," ")),className:se.textField,"data-testid":"external-idp-token"}))))))),s.a.createElement(c.a,null,s.a.createElement("div",{className:se.inputWrapper},s.a.createElement(x.a,{container:!0,spacing:3},s.a.createElement(x.a,{item:!0,xs:12},s.a.createElement(f.a,{fullScreen:de,open:l,onClose:ke,"aria-labelledby":"responsive-dialog-title",className:se.dialogWrapper},s.a.createElement(T.a,{id:"responsive-dialog-title"},ye),s.a.createElement(A.a,null,!b&&!ae&&!C&&s.a.createElement(he.a,null,!y&&N&&s.a.createElement(be.a,{updateAccessTokenRequest:e=>{j({field:"accessTokenRequest",value:e})},accessTokenRequest:L,subscriptionScopes:B}),!y&&!N&&s.a.createElement(s.a.Fragment,null,s.a.createElement(p.a,null,s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewCurl.error",defaultMessage:"Please generate the Consumer Key and Secret for Residence Key Manager with selecting the urn:ietf:params:oauth:grant-type:token-exchange grant type in order to use the token Exchange Approach. "}))),y&&s.a.createElement(Ee.a,{token:_e(_e({},U),{},{isOauth:!0}),isResidenceTokenAvailable:N,isTokenExchange:!0})),b&&s.a.createElement(he.a,null,s.a.createElement(ve,{keys:{consumerKey:Te,consumerSecret:Se},keyType:ue,jwtToken:G,keyManagerConfig:re,defaultTokenEndpoint:ie}))),s.a.createElement(k.a,null,P&&s.a.createElement(g.a,{size:24}),!y&&!b&&!C&&N&&s.a.createElement(o.a,{onClick:()=>{I(!0),ge.then(e=>e.generateToken(oe,L.keyType,L.timeout,L.scopesSelected,!0,G)).then(e=>{console.log("token generated successfully "+e),h(!0),j({field:"tokenResponse",value:e}),j({field:"token",value:e.accessToken}),j({field:"tokenScopes",value:e.tokenScopes}),j({field:"tokenValidityTime",value:e.validityTime}),I(!1)}).catch(e=>{const{status:a}=e;404===a?w(!0):400===a&&E.a.error(e.description||ne.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.generate.bad.request.error",defaultMessage:"Error occurred when generating Access Token"})),I(!1);const{response:t}=e;t&&t.body&&E.a.error(t.body.message)})},color:"primary",disabled:P},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewKeys.consumer.generate.btn",defaultMessage:"Generate"})),s.a.createElement(o.a,{onClick:ke,color:"primary",autoFocus:!0},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewKeys.consumer.close.btn",defaultMessage:"Close"})))),s.a.createElement("div",{className:se.generateWrapper},s.a.createElement(x.a,{className:se.bottomInfo},s.a.createElement(d.a,{id:"application.productionKeys.oAuth.externalIdp.tokenGeneration.token.description",defaultMessage:"In Exchange token flow, A JWT token has to be generated from the {selectedIdpType}\n                                             idp and then exchange for a token with the Resident Key Manager which can used to invoke APIs",values:{selectedIdpType:re.type}})),s.a.createElement(o.a,{variant:"outlined",size:"small",color:"primary",className:se.margin,onClick:()=>{u(!0)},disabled:W||""===G},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewKeys.generate.access.token",defaultMessage:"Generate Access Token"})),s.a.createElement(o.a,{id:"curl-to-generate-access-token-btn",variant:"outlined",size:"small",color:"primary",className:se.margin,onClick:()=>{u(!0),S(!0)},disabled:W||""===G},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewKeys.curl.to.generate",defaultMessage:"CURL to Generate Access Token"}))))))))};Ue.defaultProps={notFound:!1,validating:!1,fullScreen:!1,summary:!1},Ue.propTypes={classes:i.a.instanceOf(Object).isRequired,keyRequest:i.a.shape({callbackUrl:i.a.string,selectedGrantTypes:i.a.array}).isRequired,isUserOwner:i.a.bool.isRequired,isKeysAvailable:i.a.bool.isRequired,keyManagerConfig:i.a.any.isRequired,notFound:i.a.bool,setGenerateEnabled:i.a.func,updateKeyRequest:i.a.func.isRequired,validating:i.a.bool,defaultTokenEndpoint:i.a.string,selectedApp:i.a.shape({tokenType:i.a.string.isRequired,appId:i.a.string,value:i.a.string,owner:i.a.string,hashEnabled:i.a.bool})};var Le=Object(l.a)(e=>({FormControl:{paddingTop:0,paddingBottom:e.spacing(2),paddingLeft:0,width:"100%"},FormControlOdd:{padding:e.spacing(2),width:"100%"},button:{marginLeft:e.spacing(1)},quotaHelp:{position:"relative"},checkboxWrapper:{display:"flex"},generateWrapper:{padding:"10px 0px",marginLeft:e.spacing(1.25)},checkboxWrapperColumn:{display:"flex",flexWrap:"wrap",flexDirection:"row",whiteSpace:"nowrap"},group:{flexDirection:"row"},removeHelperPadding:{"& p":{margin:"8px 0px"}},iconStyle:{cursor:"pointer",padding:"0 0 0 10px"},iconButton:{padding:"0 0 0 10px","& .material-icons":{fontSize:16}},titleColumn:{width:150,fontWeight:500},keyInfoTable:{marginBottom:20,borderCollapse:"collapse","& td":{paddingBottom:5,borderBottom:"solid 1px #cccc"}},leftCol:{width:180},stepLabel:{color:"#5567d5",alignSelf:"center"},stepContent:{color:"#1D2028",fontSize:"0.75rem"},keyLabel:{color:"#222228",fontSize:"0.75rem",marginLeft:e.spacing(1)},idpGrid:{textAlign:"left",margin:e.spacing(0),alignSelf:"center"},helperTextError:{display:"flex",alignItems:"center",fontSize:10.5},input:{marginLeft:e.spacing(1),flex:1},avatar:{width:30,height:30,background:"transparent",border:"solid 1px "+e.palette.grey[300]},copyIconStyle:{cursor:"pointer",margin:"-10px 0",padding:"0 0 0 5px","& .material-icons":{fontSize:18,color:"#9c9c9c"}},hr:{border:"solid 1px #efefef"},divCenter:{alignSelf:"center",width:180},tableHeader:{borderBottom:"none"},helperText:{marginLeft:0,color:"#8D91A3",lineHeight:1.6,maxWidth:410},dialogWrapper:{"& label,& h5, & label, & td, & li, & input, & h2, & p.MuiTypography-root,& p.MuiFormHelperText-root":{color:e.palette.getContrastText(e.palette.background.paper)}},margin:{marginRight:e.spacing(2)},tokenSection:{marginTop:0,marginBottom:e.spacing(.5)},inputWrapper:{display:"flex",flexDirection:"row",alignItems:"center","& span, & h5, & label, & td, & li, & div, & input":{color:e.palette.getContrastText(e.palette.background.paper)}},bottomInfo:{fontSize:12,marginBottom:"10px"}}))(Ue),Ge=t(1926),We=t(2194);const Be=["children","value","index"];function Ve(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function ze(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?Ve(Object(t),!0).forEach((function(a){Fe(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ve(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function Fe(e,a,t){return(a=function(e){var a=function(e,a){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(e,"string");return"symbol"==typeof a?a:String(a)}(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function He(){return(He=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function Je(e,a){if(null==e)return{};var t,n,s=function(e,a){if(null==e)return{};var t,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}function Xe(e){const{children:a,value:t,index:n}=e,r=Je(e,Be);return s.a.createElement("div",He({role:"tabpanel",hidden:t!==n,id:"nav-tabpanel-"+n,"aria-labelledby":"nav-tab-"+n},r),t===n&&s.a.createElement(c.a,{p:3},a))}Xe.propTypes={children:i.a.node,index:i.a.any.isRequired,value:i.a.any.isRequired};Object(l.a)({indicator:{display:"flex",justifyContent:"center",backgroundColor:"transparent","& > span":{width:"98%",backgroundColor:"#ffffff"},transition:"none"},flexContainer:{borderBottom:"solid 1px #666",backgroundColor:"#efefef","& button:first-child":{borderLeft:"none"}}})(e=>s.a.createElement(h.a,He({},e,{TabIndicatorProps:{children:s.a.createElement("span",null)}}))),Object(l.a)(e=>({root:{textTransform:"none",color:"#666",fontWeight:e.typography.fontWeightRegular,fontSize:e.typography.pxToRem(15),marginRight:e.spacing(1),"&:focus":{opacity:1}},selected:{backgroundColor:"#fff",borderLeft:"solid 1px #666",borderRight:"solid 1px #666"}}))(e=>s.a.createElement(b.a,He({disableRipple:!0},e)));class Ye extends s.a.Component{constructor(e){super(e),Fe(this,"handleTabChange",(e,a)=>{const{keys:t,keyManagers:n,keyRequest:s}=this.state,{keyType:r}=this.props,i=n.find(e=>e.name===a),{availableGrantTypes:l}=i,o=[];if(l.find(e=>"password"===e)&&o.push("password"),l.find(e=>"client_credentials"===e)&&o.push("client_credentials"),t.size>0&&t.get(a)&&t.get(a).keyType===r){const{callbackUrl:e,supportedGrantTypes:n,additionalProperties:r,mode:l}=t.get(a),c=ze(ze({},s),{},{callbackUrl:e,selectedGrantTypes:n||o,additionalProperties:r||this.getDefaultAdditionalProperties(i)});this.setState({keyRequest:c,selectedTab:a,mode:l,importDisabled:"MAPPED"===l||"CREATED"===l})}else this.setState({keyRequest:ze(ze({},s),{},{selectedGrantTypes:o,additionalProperties:this.getDefaultAdditionalProperties(i)}),selectedTab:a,importDisabled:!1})}),Fe(this,"loadApplication",()=>{const{keyType:e,intl:a}=this.props;if(this.appId){const t=(new j.a).getKeyManagers(),n=this.application.then(a=>a.getKeys(e));Promise.all([t,n]).then(a=>{const t=[];if(a[0].body.list.map(e=>{e.enabled&&t.push(e)}),0===t.length)return void this.setState({keyManagers:[]});let{selectedTab:n}=this.state;!n&&t.length>0&&(n=t.find(e=>"Resident Key Manager"===e.name)?"Resident Key Manager":t[0].name);const s=t.find(e=>e.name===n),r=a[1],{keyRequest:i}=this.state;if(r.size>0&&r.get(n)&&r.get(n).keyType===e){const{callbackUrl:e,supportedGrantTypes:a,additionalProperties:l,mode:o}=r.get(n),c=ze(ze({},i),{},{callbackUrl:e||"",selectedGrantTypes:a||[],additionalProperties:l||this.getDefaultAdditionalProperties(s)});this.setState({keys:r,keyRequest:c,keyManagers:t,selectedTab:n,importDisabled:"MAPPED"===o||"CREATED"===o,mode:o})}else{const e=[];s.availableGrantTypes.find(e=>"password"===e)&&e.push("password"),s.availableGrantTypes.find(e=>"client_credentials"===e)&&e.push("client_credentials"),this.setState({keys:r,keyRequest:ze(ze({},i),{},{selectedGrantTypes:e,additionalProperties:this.getDefaultAdditionalProperties(s)}),keyManagers:t,selectedTab:n})}}).catch(e=>{console.error(e),404===e.status?this.setState({notFound:!0}):E.a.error(e.description||a.formatMessage({id:"Shared.AppsAndKeys.TokenManager.get.keys.request.error",defaultMessage:"Error while retrieving the keys"}))})}}),Fe(this,"setValidating",e=>{this.setState({validating:e})}),Fe(this,"updateHasError",e=>{this.setState({hasError:e})}),Fe(this,"toTitleCase",e=>e.replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())),Fe(this,"handleChange",e=>{this.setState({tokenType:e.target.defaultValue})}),Fe(this,"handleClose",()=>{this.setState({tokenType:"DIRECT"})});const{selectedApp:a,keyType:t}=this.props;this.state={isLoading:!1,keys:null,isKeyJWT:!1,hasError:!1,initialToken:"",initialValidityTime:0,initialScopes:[],keyRequest:{keyType:t,selectedGrantTypes:null,callbackUrl:"",additionalProperties:{},keyManager:"",validityTime:3600,scopes:["default"]},keyManagers:null,selectedTab:null,providedConsumerKey:"",providedConsumerSecret:"",validating:!1,importDisabled:!1,mode:null,tokenType:"DIRECT",isExchangeTokenError:!1},this.keyStates={COMPLETED:"COMPLETED",APPROVED:"APPROVED",CREATED:"CREATED",REJECTED:"REJECTED"},a&&(this.appId=a.appId||a.value,this.application=R.a.get(this.appId)),this.updateKeyRequest=this.updateKeyRequest.bind(this),this.generateKeys=this.generateKeys.bind(this),this.updateKeys=this.updateKeys.bind(this),this.cleanUpKeys=this.cleanUpKeys.bind(this),this.handleOnChangeProvidedOAuth=this.handleOnChangeProvidedOAuth.bind(this),this.provideOAuthKeySecret=this.provideOAuthKeySecret.bind(this)}componentDidMount(){this.loadApplication()}componentDidUpdate(e){const{keyType:a}=e,{keyType:t}=this.props;a!==t&&this.loadApplication()}getDefaultAdditionalProperties(e){const{availableGrantTypes:a,applicationConfiguration:t}=e,n={};return t.forEach(e=>{n[e.name]=e.default||""}),n}isTokenExchangeEnabled(){const{keyManagers:e}=this.state;let a=!1;return e&&e.length>1&&e.map(e=>{"EXCHANGED"!==e.tokenType&&"BOTH"!==e.tokenType||(a=!0)}),a}updateKeyRequest(e){this.setState({keyRequest:e})}generateKeys(){const{keyRequest:e,keys:a,selectedTab:t}=this.state,{keyType:n,updateSubscriptionData:s,selectedApp:{tokenType:r,hashEnabled:i},intl:l}=this.props;!e.selectedGrantTypes.includes("implicit")&&!e.selectedGrantTypes.includes("authorization_code")||""!==e.callbackUrl?(this.setState({isLoading:!0}),this.application.then(a=>a.generateKeys(n,e.selectedGrantTypes,e.callbackUrl,e.additionalProperties,this.getKeyManagerIdentifier())).then(e=>{s&&s();const n=new Map([...a]),o="JWT"===r||i;n.set(t,e);const c=e.token?e.token.accessToken:"",p=e.token?e.token.validityTime:0,d=e.token?e.token.tokenScopes:[];this.setState({keys:n,isKeyJWT:o,initialToken:c,initialValidityTime:p,initialScopes:d}),e.keyState===this.keyStates.CREATED||e.keyState===this.keyStates.REJECTED?E.a.info(l.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.generate.success.blocked",defaultMessage:"Application keys generate request is currently pending approval by the site administrator."})):(E.a.info(l.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.generate.success",defaultMessage:"Application keys generated successfully"})),this.loadApplication())}).catch(e=>{const{status:a}=e;404===a?this.setState({notFound:!0}):500===a&&this.loadApplication(),E.a.error(e.description||`${l.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.generate.error",defaultMessage:"Error occurred when generating application keys"})}, ${e.response.body.message}`)}).finally(()=>this.setState({isLoading:!1}))):E.a.error(l.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.generate.error.callbackempty",defaultMessage:"Callback URL can not be empty when the Implicit or Application Code grant types selected"}))}updateKeys(){const{keys:e,keyRequest:a,selectedTab:t}=this.state,{keyType:n,intl:s}=this.props,r=e.get(t).keyType===n&&e.get(t);!a.selectedGrantTypes.includes("implicit")&&!a.selectedGrantTypes.includes("authorization_code")||""!==a.callbackUrl?(this.setState({isLoading:!0}),this.application.then(e=>e.updateKeys(r.tokenType,n,a.selectedGrantTypes,a.callbackUrl,r.consumerKey,r.consumerSecret,a.additionalProperties,t,r.keyMappingId)).then(a=>{const n=new Map([...e]);n.set(t,a),this.setState({keys:n}),E.a.info(s.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.update.success",defaultMessage:"Application keys updated successfully"}))}).catch(e=>{const{status:a}=e;404===a?this.setState({notFound:!0}):500===a&&this.loadApplication();const{response:t}=e;t&&t.body&&t.body.message&&t.body.description&&E.a.error(`${t.body.message}: ${t.body.description}`)}).finally(()=>this.setState({isLoading:!1}))):E.a.error(s.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.generate.error.callbackempty",defaultMessage:"Callback URL can not be empty when the Implicit or Application Code grant types selected"}))}cleanUpKeys(e,a){const{keyType:t,intl:n}=this.props;this.application.then(n=>n.cleanUpKeys(t,e,a)).then(()=>{this.loadApplication(),E.a.info(n.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.cleanup.success",defaultMessage:"Application keys cleaned successfully"}))}).catch(e=>{const{status:a}=e;404===a&&this.setState({notFound:!0}),E.a.error(e.description||n.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.cleanup.error",defaultMessage:"Error occurred while cleaning up application keys"}))})}handleOnChangeProvidedOAuth(e){this.setState({[e.target.name]:e.target.value})}provideOAuthKeySecret(){const{keyType:e,intl:a}=this.props,{providedConsumerKey:t,providedConsumerSecret:n,selectedTab:s}=this.state;this.application.then(a=>a.provideKeys(e,t,n,s)).then(()=>{this.setState({providedConsumerKey:"",providedConsumerSecret:""}),this.loadApplication(),E.a.info(a.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.provide.success",defaultMessage:"Application keys provided successfully"}))}).catch(e=>{const{status:t,response:n}=e;404===t&&this.setState({notFound:!0}),n?E.a.error(e.response.body.description):E.a.error(e.description||a.formatMessage({id:"Shared.AppsAndKeys.TokenManager.key.provide.error",defaultMessage:"Error occurred when providing application keys"}))})}getKeyManagerDescription(){const{keyManagers:e,selectedTab:a}=this.state,t=e.filter(e=>e.name===a);return t&&1===t.length?t[0].description:""}getKeyManagerIdentifier(){const{keyManagers:e,selectedTab:a}=this.state,t=e.filter(e=>e.name===a);return t&&1===t.length?t[0].id:a}render(){const{classes:e,selectedApp:a,keyType:t,summary:n,selectedApp:{hashEnabled:r},isKeyManagerAllowed:i}=this.props,{keys:l,keyRequest:u,isLoading:E,isKeyJWT:S,providedConsumerKey:C,providedConsumerSecret:M,selectedTab:K,keyManagers:w,validating:O,hasError:P,initialToken:R,initialValidityTime:_,initialScopes:j,importDisabled:U,mode:L,tokenType:G}=this.state;if(w&&0===w.length)return s.a.createElement("div",{className:e.root},s.a.createElement(c.a,{mb:1},s.a.createElement(p.a,{variant:"h5",className:e.keyTitle},this.toTitleCase(t),s.a.createElement(d.a,{id:"Shared.AppsAndKeyhandleCloses.TokenManager.oauth2.keys.main.title",defaultMessage:" OAuth2 Keys"}))),s.a.createElement(D.a,{type:"info",className:e.dialogContainer},s.a.createElement(p.a,{variant:"h5",component:"h3"},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.TokenManager.no.km",defaultMessage:"No Key Managers"})),s.a.createElement(p.a,{component:"p"},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.TokenManager.no.km.content",defaultMessage:"No Key Managers active to generate keys."}))));if(!l||!K||!u.selectedGrantTypes)return s.a.createElement(m.a,null);const B=N.a.getUser().name;let V=!1;a.owner&&B.toLowerCase()===a.owner.toLowerCase()&&(V=!0);const z=l.size>0&&l.get(K)&&l.get(K).keyType===t?l.get(K):null;if(n)return l?s.a.createElement(Re,{keys:l,key:z,keyStates:this.keyStates,selectedApp:a,selectedTab:K,keyType:t,isKeyJWT:S,isUserOwner:V}):s.a.createElement(Ne.a,null);let F,H=!1;if(l.has("Resident Key Manager")&&l.get("Resident Key Manager").supportedGrantTypes&&l.get("Resident Key Manager").supportedGrantTypes.includes("urn:ietf:params:oauth:grant-type:token-exchange")&&(H=!0),w.length>0){const e=w.filter(e=>"Resident Key Manager"===e.name);F=e.length>0?e[0].tokenEndpoint:null}return z&&"APPROVED"===z.keyState&&!z.consumerKey?s.a.createElement(s.a.Fragment,null,s.a.createElement(p.a,{className:e.cleanUpInfoText,variant:"subtitle1"},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.TokenManager.cleanup.text",defaultMessage:"Error! You have partially-created keys. Please click `Clean Up` button and try again."})),s.a.createElement(o.a,{variant:"contained",color:"primary",className:e.cleanUpButton,onClick:()=>this.cleanUpKeys(K,l.get(K).keyMappingId)},s.a.createElement(d.a,{defaultMessage:"Clean up",id:"Shared.AppsAndKeys.TokenManager.cleanup"}))):!z||z.keyState!==this.keyStates.CREATED&&z.keyState!==this.keyStates.REJECTED?s.a.createElement(s.a.Fragment,null,w&&w.length>1&&s.a.createElement(y.a,{position:"static",color:"default"},s.a.createElement(h.a,{value:K,onChange:this.handleTabChange,indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto","aria-label":"scrollable auto tabs example"},w.map(e=>s.a.createElement(b.a,{label:e.displayName||e.name,value:e.name,disabled:!e.enabled||i&&!i(e.name)&&("Resident Key Manager"!==e.name||!this.isTokenExchangeEnabled()&&"Resident Key Manager"===e.name),id:e.name.replace(/\s/g,"")})))),s.a.createElement("div",{className:e.root},s.a.createElement(c.a,{mb:1},s.a.createElement(p.a,{variant:"h5",className:e.keyTitle},this.toTitleCase(t),s.a.createElement(d.a,{id:"Shared.AppsAndKeys.TokenManager.oauth2.keys.main.title",defaultMessage:" OAuth2 Keys"}))),w&&w.length>0&&w.map(n=>s.a.createElement("div",null,"DIRECT"===n.tokenType&&s.a.createElement(Xe,{value:K,index:n.name,className:e.tabPanel},s.a.createElement(c.a,{display:"flex",flexDirection:"row"},s.a.createElement(p.a,{className:e.subTitle,variant:"h6",component:"h6"},s.a.createElement(d.a,{defaultMessage:"Key and Secret",id:"Shared.AppsAndKeys.TokenManager.key.and.secret"})),n.enableMapOAuthConsumerApps&&s.a.createElement(c.a,{ml:2},s.a.createElement(I,{onChange:this.handleOnChangeProvidedOAuth,consumerKey:C,consumerSecret:M,isUserOwner:V,key:z,provideOAuthKeySecret:this.provideOAuthKeySecret,importDisabled:U}))),s.a.createElement(c.a,{m:2},s.a.createElement(Oe,{initialToken:R,initialValidityTime:_,initialScopes:j,selectedApp:a,selectedTab:K,keyType:t,keys:l,selectedGrantTypes:u.selectedGrantTypes,isUserOwner:V,hashEnabled:n.enableTokenHashing||r,keyManagerConfig:n,mode:L})),s.a.createElement(p.a,{className:e.subTitle,variant:"h6",component:"h6"},z?s.a.createElement(d.a,{defaultMessage:"Key Configurations",id:"Shared.AppsAndKeys.TokenManager.update.configuration"}):s.a.createElement(d.a,{defaultMessage:"Key Configuration",id:"Shared.AppsAndKeys.TokenManager.key.configuration"})),s.a.createElement(c.a,{m:2},s.a.createElement(ge,{keys:l,key:z,selectedApp:a,selectedTab:K,keyType:t,updateKeyRequest:this.updateKeyRequest,keyRequest:u,isUserOwner:V,isKeysAvailable:!!z,keyManagerConfig:n,validating:O,updateHasError:this.updateHasError,callbackError:P,setValidating:this.setValidating,defaultTokenEndpoint:F,mode:L}),s.a.createElement("div",{className:e.generateWrapper},s.a.createElement(v.a,{resourcePath:v.c.APPLICATION_GENERATE_KEYS,resourceMethod:v.b.POST},V?s.a.createElement(c.a,{display:"flex"},s.a.createElement(o.a,{id:"generate-keys",variant:"contained",color:"primary",className:e.button,onClick:z?this.updateKeys:this.generateKeys,disabled:P||E||!n.enableOAuthAppCreation||L&&"MAPPED"===L||i&&!i(n.name)&&("Resident Key Manager"!==n.name||!this.isTokenExchangeEnabled()&&"Resident Key Manager"===n.name)},z?this.props.intl.formatMessage({id:"Shared.AppsAndKeys.TokenManager.update",defaultMessage:"Update"}):this.props.intl.formatMessage({id:"Shared.AppsAndKeys.TokenManager.generate.keys",defaultMessage:"Generate Keys"}),E&&s.a.createElement(g.a,{size:20})),!n.enableOAuthAppCreation&&s.a.createElement(c.a,{m:2,display:"flex"},s.a.createElement(q.a,{className:e.warningIcon}),s.a.createElement(p.a,{variant:"body1"},s.a.createElement(d.a,{defaultMessage:"Oauth app creation disabled for {kmName} key manager",id:"Shared.AppsAndKeys.TokenManager.app.creation.disable.warn",values:{kmName:n.displayName||n.name}})))):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{id:"generate-keys",variant:"contained",color:"primary",className:e.button,onClick:z?this.updateKeys:this.generateKeys,disabled:!V||E||!n.enableOAuthAppCreation||i&&!i(n.name)&&("Resident Key Manager"!==n.name||!this.isTokenExchangeEnabled()&&"Resident Key Manager"===n.name)},z?this.props.intl.formatMessage({id:"Shared.AppsAndKeys.TokenManager.update.keys",defaultMessage:"Update Keys"}):this.props.intl.formatMessage({id:"Shared.AppsAndKeys.TokenManager.generate.keys",defaultMessage:"Generate Keys"}),E&&s.a.createElement(g.a,{size:20})),s.a.createElement(p.a,{variant:"caption"},s.a.createElement(d.a,{defaultMessage:"Only owner can generate or update keys",id:"Shared.AppsAndKeys.TokenManager.key.and.user.owner"}))))))),"EXCHANGED"===n.tokenType&&s.a.createElement(Xe,{value:K,index:n.name,className:e.tabPanel},s.a.createElement(p.a,{className:e.subTitle,variant:"h6",component:"h6"},s.a.createElement(d.a,{defaultMessage:"Token Generation",id:"Shared.AppsAndKeys.TokenManager.ExchangeToken.key.configuration"})),s.a.createElement(c.a,{m:2},s.a.createElement(Le,{keys:l,key:z,selectedApp:a,selectedTab:K,keyType:t,updateKeyRequest:this.updateKeyRequest,keyRequest:u,isUserOwner:V,isKeysAvailable:!!z,keyManagerConfig:n,validating:O,updateHasError:this.updateHasError,callbackError:P,setValidating:this.setValidating,defaultTokenEndpoint:F}))),"BOTH"===n.tokenType&&s.a.createElement(Xe,{value:K,index:n.name,className:e.tabPanel},s.a.createElement(c.a,{m:2},s.a.createElement(c.a,{m:2},s.a.createElement(c.a,{display:"flex",alignItems:"center"},s.a.createElement(J.a,{className:e.table},s.a.createElement($.a,null,s.a.createElement(Y.a,{component:"th",scope:"row",className:e.leftCol},s.a.createElement(d.a,{defaultMessage:"API Invocation Method",id:"Shared.AppsAndKeys.KeyConfiguration.API Invocation.Method.label"})),s.a.createElement(Y.a,null,s.a.createElement(Ge.a,{style:{flexDirection:"row"},"aria-label":"tokenType",name:"tokenType",value:G,onChange:this.handleChange},s.a.createElement(W.a,{value:"DIRECT",control:s.a.createElement(We.a,null),label:"Direct Token",id:"direct-token"}),s.a.createElement(W.a,{value:"EXCHANGED",control:s.a.createElement(We.a,null),label:"Exchange Token",id:"exchange-token"}))))))),"DIRECT"===G&&s.a.createElement(s.a.Fragment,null,s.a.createElement(c.a,{display:"flex",flexDirection:"row"},s.a.createElement(p.a,{className:e.subTitle,variant:"h6",component:"h6"},s.a.createElement(d.a,{defaultMessage:"Key and Secret",id:"Shared.AppsAndKeys.TokenManager.key.and.secret"})),n.enableMapOAuthConsumerApps&&s.a.createElement(c.a,{ml:2},s.a.createElement(I,{onChange:this.handleOnChangeProvidedOAuth,consumerKey:C,consumerSecret:M,isUserOwner:V,key:z,provideOAuthKeySecret:this.provideOAuthKeySecret,importDisabled:U}))),s.a.createElement(c.a,{m:2},s.a.createElement(Oe,{initialToken:R,initialValidityTime:_,initialScopes:j,selectedApp:a,selectedTab:K,keyType:t,keys:l,selectedGrantTypes:u.selectedGrantTypes,isUserOwner:V,hashEnabled:n.enableTokenHashing||r,keyManagerConfig:n,mode:L})),s.a.createElement(p.a,{className:e.subTitle,variant:"h6",component:"h6"},z?s.a.createElement(d.a,{defaultMessage:"Key Configurations",id:"Shared.AppsAndKeys.TokenManager.update.configuration"}):s.a.createElement(d.a,{defaultMessage:"Key Configuration",id:"Shared.AppsAndKeys.TokenManager.key.configuration"})),s.a.createElement(c.a,{m:2},s.a.createElement(ge,{keys:l,key:z,selectedApp:a,selectedTab:K,keyType:t,updateKeyRequest:this.updateKeyRequest,keyRequest:u,isUserOwner:V,isKeysAvailable:!!z,keyManagerConfig:n,validating:O,updateHasError:this.updateHasError,callbackError:P,setValidating:this.setValidating,defaultTokenEndpoint:F}),s.a.createElement("div",{className:e.generateWrapper},s.a.createElement(v.a,{resourcePath:v.c.APPLICATION_GENERATE_KEYS,resourceMethod:v.b.POST},V?s.a.createElement(c.a,{display:"flex"},s.a.createElement(o.a,{id:"generate-keys",variant:"contained",color:"primary",className:e.button,onClick:z?this.updateKeys:this.generateKeys},z?"Update":"Generate Keys",E&&s.a.createElement(g.a,{size:20})),!n.enableOAuthAppCreation&&s.a.createElement(c.a,{m:2,display:"flex"},s.a.createElement(q.a,{className:e.warningIcon}),s.a.createElement(p.a,{variant:"body1"},s.a.createElement(d.a,{defaultMessage:"Oauth app creation disabled for {kmName} key manager",id:"Shared.AppsAndKeys.TokenManager.app.creation.disable.warn",values:{kmName:n.displayName||n.name}})))):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{id:"generate-keys",variant:"contained",color:"primary",className:e.button,onClick:z?this.updateKeys:this.generateKeys},z?"Update keys":"Generate Keys",E&&s.a.createElement(g.a,{size:20})),s.a.createElement(p.a,{variant:"caption"},s.a.createElement(d.a,{defaultMessage:"Only owner can generate or update keys",id:"Shared.AppsAndKeys.TokenManager.key.and.user.owner"}))))))),"EXCHANGED"===G&&H&&s.a.createElement(Xe,{value:K,index:n.name,className:e.tabPanel},s.a.createElement(p.a,{className:e.subTitle,variant:"h6",component:"h6"},s.a.createElement(d.a,{defaultMessage:"Token Generation",id:"Shared.AppsAndKeys.TokenManager.ExchangeToken.key.configuration"})),s.a.createElement(c.a,{m:2},s.a.createElement(Le,{keys:l,key:z,selectedApp:a,selectedTab:K,keyType:t,updateKeyRequest:this.updateKeyRequest,keyRequest:u,isUserOwner:V,isKeysAvailable:!!z,keyManagerConfig:n,validating:O,updateHasError:this.updateHasError,callbackError:P,setValidating:this.setValidating,defaultTokenEndpoint:F})))))))),"EXCHANGED"===G&&!H&&s.a.createElement("div",{className:e.inputWrapper},s.a.createElement(x.a,{container:!0,spacing:3},s.a.createElement(x.a,{item:!0,xs:12},s.a.createElement(f.a,{fullScreen:!1,open:!0,onClose:this.handleClose,"aria-labelledby":"responsive-dialog-title",className:e.dialogWrapper},s.a.createElement(T.a,{id:"responsive-dialog-title"},"Resident Key Manager Consumer Key and Secret Not Available "),s.a.createElement(A.a,null,s.a.createElement(he.a,null,s.a.createElement(s.a.Fragment,null,s.a.createElement(p.a,null,s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewCurl.error",defaultMessage:"Please generate the Consumer Key and Secret for Residence Key Manager with selecting the urn:ietf:params:oauth:grant-type:token-exchange grant type in order to use the token Exchange Approach. "}))))),s.a.createElement(k.a,null,s.a.createElement(o.a,{onClick:this.handleClose,color:"primary",autoFocus:!0,id:"close-btn"},s.a.createElement(d.a,{id:"Shared.AppsAndKeys.ViewKeys.consumer.close.btn",defaultMessage:"Close"})))))))):s.a.createElement(Pe,{keyState:z.keyState,states:this.keyStates})}}Fe(Ye,"contextType",Settings),Ye.defaultProps={updateSubscriptionData:()=>{},summary:!1},Ye.propTypes={classes:i.a.instanceOf(Object).isRequired,selectedApp:i.a.shape({tokenType:i.a.string.isRequired,appId:i.a.string,value:i.a.string,owner:i.a.string,hashEnabled:i.a.bool}).isRequired,keyType:i.a.string.isRequired,updateSubscriptionData:i.a.func,intl:i.a.shape({formatMessage:i.a.func}).isRequired,summary:i.a.bool};a.a=Object(u.c)(Object(l.a)(e=>({root:{padding:e.spacing(3),"& span, & h6, & label, & input":{color:e.palette.getContrastText(e.palette.background.paper)},"& .Mui-disabled span":{color:e.palette.grey[500]},"& input:disabled":{backgroundColor:e.palette.grey[100],color:e.palette.grey[500]},position:"relative"},button:{marginLeft:0,"& span":{color:e.palette.getContrastText(e.palette.primary.main)},marginRight:e.spacing(2)},cleanUpButton:{marginLeft:15},cleanUpInfoText:{padding:"10px 0px 10px 15px"},tokenSection:{marginTop:e.spacing(2),marginBottom:e.spacing(2)},margin:{marginRight:e.spacing(2)},keyConfigWrapper:{flexDirection:"column",marginBottom:0},generateWrapper:{padding:"10px 0px",marginLeft:e.spacing(1.25)},paper:{background:"none",marginBottom:e.spacing(2),marginTop:e.spacing(2)},muiFormGroupRoot:{flexDirection:"row"},formControl:{},subTitle:{fontWeight:400},tabPanel:{paddingLeft:e.spacing(2),"& .MuiBox-root":{padding:0}},warningIcon:{color:"#ff9a00",fontSize:20,marginRight:10},leftCol:{width:180}}))(Ye))},5025:function(e,a,t){"use strict";t.r(a);var n=t(2),s=t.n(n),r=t(22),i=t.n(r),l=t(535),o=t(1213),c=t(1655),p=t(1678),d=t(1553),u=t(1292),m=t(1666),g=t(1307);const y=Object(m.a)(e=>({appContent:{margin:e.spacing(2)},button:{color:e.palette.getContrastText(e.palette.primary.main)}}));var h=e=>{const{handleClick:a,heading:t,caption:n,buttonText:r}=e,i=y();return s.a.createElement("div",{className:i.appContent},s.a.createElement(u.a,{type:"info",className:i.dialogContainer},s.a.createElement(c.a,{variant:"h5",component:"h2"},t),s.a.createElement(c.a,{variant:"body2",gutterBottom:!0},n),s.a.createElement(g.a,{resourcePath:g.c.APPLICATIONS,resourceMethod:g.b.POST},s.a.createElement(p.a,{variant:"contained",color:"primary",className:i.button,onClick:a,id:"start-key-gen-wizard-btn"},r))))},b=t(4978),E=t(352),f=t(1225),k=t(1660),A=t(1679),T=t(4991),S=t(5001),C=t(1653),v=t(361),M=t(1279),K=t(48),w=t(2242),x=t(2131),O=t.n(x);var P=e=>{const{classes:a,originalDevPortalUrl:t}=e;return s.a.createElement(k.a,{elevation:0,className:a.paper},s.a.createElement(c.a,{variant:"h5",component:"h2"},s.a.createElement(C.a,{id:"Apis.Details.Credentials.OriginalDevportalDetails.original.developer.portal.title",defaultMessage:"Original Developer Portal"})),s.a.createElement(S.a,{target:"_blank",rel:"noopener noreferrer",href:t,variant:"body2"},s.a.createElement("div",{className:a.originalDevPortalLink,"data-testid":"itest-original-devportal-link"},s.a.createElement(C.a,{id:"Apis.Details.Credentials.OriginalDevportalDetails.visit.original.developer.portal",defaultMessage:"Visit Original Developer Portal"}),s.a.createElement(O.a,{className:a.launchIcon}))))},I=t(1239),R=t(1238),N=t.n(R),D=t(1305),_=t(2192);const q=e=>{const{classes:a,loadInfo:t,handleSubscriptionDelete:n,isKeyManagerAllowed:r,theme:i,selectedAppId:o,updateSubscriptionData:c,selectedKeyType:p,app:d,applicationOwner:u,hashEnabled:m}=e;return s.a.createElement(s.a.Fragment,null,s.a.createElement("tr",null,s.a.createElement("td",{className:a.td,id:d.label},d.label),s.a.createElement("td",{className:a.td},d.policy),s.a.createElement("td",{className:a.td},d.status),s.a.createElement("td",{className:a.td},s.a.createElement("div",{className:a.actionColumn},s.a.createElement(S.a,{className:a.button,to:"/applications/"+d.value,id:d.label+"-MA","aria-labelledby":d.label+"-MA "+d.label,component:l.c},s.a.createElement("span",null,s.a.createElement(C.a,{id:"Apis.Details.Credentials.SubscriptionTableRow.manage.app",defaultMessage:"MANAGE APP"})),s.a.createElement(D.a,{width:16,height:16,strokeColor:i.palette.primary.main,icon:"applications"})),s.a.createElement(g.a,{resourcePath:g.c.SINGLE_SUBSCRIPTION,resourceMethod:g.b.DELETE},s.a.createElement(S.a,{className:a.button,onClick:e=>{e.preventDefault(),n(d.subscriptionId,c)},id:d.label+"-UN","aria-labelledby":d.label+"-UN "+d.label},s.a.createElement("span",null,s.a.createElement(C.a,{id:"Apis.Details.Credentials.SubscriptionTableRow.unsubscribe",defaultMessage:"UNSUBSCRIBE"})),s.a.createElement(D.a,{width:16,height:16,strokeColor:i.palette.primary.main,icon:"subscriptions"}))),s.a.createElement(S.a,{className:N()(a.button,{[a.activeLink]:o&&"PRODUCTION"===p&&d.value===o}),onClick:()=>t("PRODUCTION",d.value),id:d.label+"-PK","aria-labelledby":d.label+"-PK "+d.label},s.a.createElement("span",null,s.a.createElement(C.a,{id:"Apis.Details.Credentials.SubscriptionTableRow.prod.keys",defaultMessage:"PROD KEYS"})),s.a.createElement(D.a,{width:16,height:16,strokeColor:i.palette.primary.main,icon:"productionkeys"})),s.a.createElement(S.a,{className:N()(a.button,{[a.activeLink]:o&&"SANDBOX"===p&&d.value===o}),onClick:()=>t("SANDBOX",d.value),id:d.label+"-SB","aria-labelledby":d.label+"-SB "+d.label},s.a.createElement("span",null,s.a.createElement(C.a,{id:"Apis.Details.Credentials.SubscriptionTableRow.sandbox.keys",defaultMessage:"SANDBOX KEYS"})),s.a.createElement(D.a,{width:16,height:16,strokeColor:i.palette.primary.main,icon:"productionkeys"}))))),d.value===o&&("PRODUCTION"===p||"SANDBOX"===p)&&s.a.createElement("tr",null,s.a.createElement("td",{colSpan:"4"},s.a.createElement("div",{className:a.selectedWrapper},s.a.createElement(_.a,{isKeyManagerAllowed:r,keyType:p,selectedApp:{appId:d.value,label:d.label,owner:u,hashEnabled:m},updateSubscriptionData:c})))))};q.propTypes={classes:i.a.shape({td:i.a.shape({}),actionColumn:i.a.shape({}),button:i.a.shape({}),activeLink:i.a.shape({}),selectedWrapper:i.a.shape({})}).isRequired,theme:i.a.shape({}).isRequired,handleSubscriptionDelete:i.a.func.isRequired,loadInfo:i.a.func.isRequired,selectedAppId:i.a.string.isRequired,updateSubscriptionData:i.a.func.isRequired,selectedKeyType:i.a.string.isRequired,applicationOwner:i.a.string.isRequired,app:i.a.shape({label:i.a.string,policy:i.a.string,status:i.a.string,value:i.a.string,subscriptionId:i.a.string}).isRequired};var j=Object(o.a)(e=>({button:{padding:e.spacing(1),color:e.palette.getContrastText(e.palette.background.default),display:"flex",alignItems:"center",fontSize:"11px",cursor:"pointer","& span":{paddingLeft:6,display:"inline-block"}},actionColumn:{display:"flex",textAlign:"right",direction:"rtl"},td:{color:e.palette.getContrastText(e.palette.background.default),borderBottom:"solid 1px "+e.palette.grey.A200,fontSize:"11px",paddingLeft:e.spacing(1),height:35},selectedWrapper:{borderLeft:"solid 2px "+e.palette.primary.main}}),{withTheme:!0})(q);function U(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function L(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?U(Object(t),!0).forEach((function(a){G(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):U(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function G(e,a,t){return(a=function(e){var a=function(e,a){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(e,"string");return"symbol"==typeof a?a:String(a)}(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class W extends s.a.Component{constructor(e){super(e),G(this,"updateData",()=>{const{api:e,applicationsAvailable:a}=this.context,{subscriptionRequest:t}=this.state,n=L(L({},t),{},{apiId:e.id}),s=e.tiers;s&&s[0]&&(n.throttlingPolicy=s[0].tierName),a&&a[0]&&(n.applicationId=a[0].value),this.setState({subscriptionRequest:n,throttlingPolicyList:s})}),G(this,"handleExpandClick",()=>{this.setState(e=>({expanded:!e.expanded}))}),G(this,"handleSubscribe",()=>{const{updateSubscriptionData:e,apiType:a}=this.context,{subscriptionRequest:t}=this.state,{intl:n}=this.props,s=new E.a;this.setState({isSubscribing:!0}),s.subscribe(t.apiId,t.applicationId,t.throttlingPolicy,a).then(a=>{"ON_HOLD"===a.body.status?f.a.info(n.formatMessage({defaultMessage:"Your subscription request has been submitted and is now awaiting approval.",id:"subscription.pending"})):(console.log("Subscription created successfully with ID : "+a.body.subscriptionId),f.a.info(n.formatMessage({defaultMessage:"Subscribed successfully",id:"Apis.Details.Credentials.Credentials.subscribed.successfully"}))),e&&e(this.updateData),this.setState({isSubscribing:!1})}).catch(e=>{f.a.error(n.formatMessage({id:"Applications.Details.Subscriptions.error.occurred.during.subscription.not.201",defaultMessage:"Error occurred during subscription"})),console.log("Error while creating the subscription."),console.error(e),this.setState({isSubscribing:!1})})}),G(this,"goToWizard",()=>{const{history:e}=this.props;e.push("credentials/wizard")}),G(this,"loadInfo",(e,a)=>{this.setState({selectedKeyType:e,selectedAppId:a}),M.a.get(a).then(e=>{this.setState({applicationOwner:e.owner,hashEnabled:e.hashEnabled})})}),G(this,"isKeyManagerAllowed",e=>{const{api:a}=this.context;return a&&(a.keyManagers&&a.keyManagers.includes("all")||a.keyManagers&&a.keyManagers.includes(e))}),G(this,"updateSubscriptionRequest",e=>{this.setState({subscriptionRequest:e})}),G(this,"handleSubscriptionDelete",(e,a)=>{const{intl:t}=this.props;(new d.a).deleteSubscription(e).then(e=>{if(200!==e.status)return console.log(e),void f.a.info(t.formatMessage({defaultMessage:"Something went wrong while deleting the Subscription!",id:"Apis.Details.Credentials.Credentials.something.went.wrong.with.subscription"}));f.a.info(t.formatMessage({defaultMessage:"Subscription deleted successfully!",id:"Apis.Details.Credentials.Credentials.subscription.deleted.successfully"})),a&&a(this.updateData)})}),this.state={expanded:!0,selectedAppId:!1,selectedKeyType:!1,subscriptionRequest:{applicationId:"",apiId:"",throttlingPolicy:""},throttlingPolicyList:[],applicationOwner:"",hashEnabled:!1,isSubscribing:!1},this.api=new E.a}componentDidMount(){const{api:e,updateSubscriptionData:a}=this.context;e?this.updateData():a(this.updateData)}render(){const{classes:e,intl:a}=this.props,{api:t,updateSubscriptionData:n,applicationsAvailable:r,subscribedApplications:i}=this.context,{selectedKeyType:o,selectedAppId:d,subscriptionRequest:m,throttlingPolicyList:y,applicationOwner:E,hashEnabled:f,isSubscribing:v}=this.state,M=K.a.getUser(),x=t.securityScheme.includes("mutualssl")&&!t.securityScheme.includes("oauth2")&&!t.securityScheme.includes("api_key")&&!t.securityScheme.includes("basic_auth"),O=t.securityScheme.includes("basic_auth")&&!t.securityScheme.includes("oauth2")&&!t.securityScheme.includes("api_key"),I=t.keyManagers&&t.keyManagers.includes("all")||t.keyManagers&&t.keyManagers.includes("Resident Key Manager");return s.a.createElement(A.a,{container:!0},s.a.createElement(A.a,{item:!0,md:12,lg:11},s.a.createElement(A.a,{container:!0,spacing:2},s.a.createElement(A.a,{item:!0,md:12},t.advertiseInfo&&t.advertiseInfo.advertised&&t.advertiseInfo.originalDevPortalUrl&&s.a.createElement(P,{classes:e,originalDevPortalUrl:t.advertiseInfo.originalDevPortalUrl}),t.tiers.length>0?s.a.createElement(s.a.Fragment,null,s.a.createElement(c.a,{onClick:this.handleExpandClick,variant:"h4",component:"div",className:e.titleSub},r.length>0&&s.a.createElement(S.a,{to:x||O||!I?null:`/apis/${t.id}/credentials/wizard`,style:t.isSubscriptionAvailable?null:{pointerEvents:"none"},className:e.addLinkWrapper,component:l.c},s.a.createElement(p.a,{color:"secondary",disabled:!t.isSubscriptionAvailable||x||O||!I,size:"small",id:"start-key-gen-wizard-btn"},s.a.createElement(T.a,null,"add_circle_outline"),s.a.createElement(C.a,{id:"Apis.Details.Credentials.SubscibeButtonPanel.subscribe.wizard.with.new.app",defaultMessage:"Subscription & Key Generation Wizard"})))),s.a.createElement(k.a,{elevation:0,className:e.paper},s.a.createElement(c.a,{variant:"body2",className:e.descWrapper},s.a.createElement(C.a,{id:"Apis.Details.Credentials.Credentials.",defaultMessage:"An application is primarily used to decouple the \n                                                consumer from the APIs. It allows you to generate and use a single \n                                                key for multiple APIs and subscribe multiple times to a single API \n                                                with different SLA levels."})),(()=>x||O?s.a.createElement(u.a,{type:"info",className:e.dialogContainer},s.a.createElement(c.a,{component:"p"},s.a.createElement(C.a,{id:"Apis.Details.Creadentials.credetials.mutualssl",defaultMessage:"Subscription is not required for Mutual SSL APIs or APIs with only Basic Authentication."}))):0===r.length&&0===i.length?s.a.createElement(h,{classes:e,handleClick:this.goToWizard,heading:M?a.formatMessage({defaultMessage:"Subscribe",id:"Apis.Details.Credentials.Credentials.subscribe.to.application"}):a.formatMessage({defaultMessage:"Sign In to Subscribe",id:"Apis.Details.Credentials.Credentials.subscribe.to.application.sign.in"}),caption:a.formatMessage({defaultMessage:"You need to subscribe to an application to access this API",id:"Apis.Details.Credentials.Credentials.subscribe.to.application.msg"}),buttonText:a.formatMessage({defaultMessage:"Subscribe",id:"Apis.Details.Credentials.Credentials.generate"})}):s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:e.generateCredentialWrapper},s.a.createElement(g.a,{resourcePath:g.c.SUBSCRIPTIONS,resourceMethod:g.b.POST},s.a.createElement(c.a,{variant:"h5",component:"h2"},s.a.createElement(C.a,{id:"Apis.Details.Credentials.Credentials.subscribe.to.application",defaultMessage:"Subscribe"})),s.a.createElement("div",{className:e.credentialBoxWrapper},0===r.length&&s.a.createElement("div",{className:e.credentialBox},s.a.createElement(c.a,{variant:"body2"},s.a.createElement(C.a,{id:"Apis.Details.Credentials.Credentials.api.credentials.with.wizard.message",defaultMessage:"Use the Subscription and Key Generation Wizard. Create a new application -> Subscribe -> Generate keys and Access Token to invoke this API."})),s.a.createElement(p.a,{variant:"contained",color:"primary",className:e.buttonElm,to:x||O||!I?null:`/apis/${t.id}/credentials/wizard`,component:l.c,disabled:!t.isSubscriptionAvailable||x||O||!I},s.a.createElement(C.a,{id:"Apis.Details.Credentials.SubscibeButtonPanel.subscribe.wizard.with.new.app",defaultMessage:"Subscription & Key Generation Wizard"}))),r.length>0&&s.a.createElement("div",{className:e.credentialBox},s.a.createElement(c.a,{variant:"body2"},s.a.createElement(C.a,{id:"Apis.Details.Credentials.Credentials.api.credentials.with.subscribe.message",defaultMessage:"Subscribe to an application and generate credentials"})),s.a.createElement(w.a,{applicationsAvailable:r,subscriptionRequest:m,throttlingPolicyList:y,updateSubscriptionRequest:this.updateSubscriptionRequest,renderSmall:!0}),s.a.createElement(p.a,{variant:"contained",color:"primary",className:e.buttonElm,onClick:()=>this.handleSubscribe(),disabled:!t.isSubscriptionAvailable||v,id:"subscribe-to-api-btn"},s.a.createElement(C.a,{id:"Apis.Details.Credentials.SubscibeButtonPanel.subscribe.btn",defaultMessage:"Subscribe"}),v&&s.a.createElement(b.a,{size:24})))))),i&&i.length>0&&s.a.createElement(s.a.Fragment,null,s.a.createElement(c.a,{variant:"h5",component:"h2",className:e.subsListTitle},s.a.createElement(C.a,{id:"Apis.Details.Credentials.Credentials.api.credentials.subscribed.apps.title",defaultMessage:"Subscriptions"})),s.a.createElement(c.a,{variant:"body2",className:e.subsListDesc},s.a.createElement(C.a,{id:"Apis.Details.Credentials.Credentials.api.credentials.subscribed.apps.description",defaultMessage:"( Applications Subscribed to this Api )"})),s.a.createElement("div",{className:e.tableMain},s.a.createElement("table",{id:"subscription-table"},s.a.createElement("tr",null,s.a.createElement("th",{className:e.th},s.a.createElement(C.a,{id:"Apis.Details.Credentials.Credentials.api.credentials.subscribed.apps.name",defaultMessage:"Application Name"})),s.a.createElement("th",{className:e.th},s.a.createElement(C.a,{id:"Apis.Details.Credentials.Credentials.api.credentials.subscribed.apps.tier",defaultMessage:"Throttling Tier"})),s.a.createElement("th",{className:e.th},s.a.createElement(C.a,{id:"Apis.Details.Credentials.Credentials.api.credentials.subscribed.apps.status",defaultMessage:"Application Status"})),s.a.createElement("th",{className:e.th},s.a.createElement(C.a,{id:"Apis.Details.Credentials.Credentials.api.credentials.subscribed.apps.action",defaultMessage:"Actions"}))),i.map((e,a)=>s.a.createElement(j,{key:e.id,loadInfo:this.loadInfo,isKeyManagerAllowed:this.isKeyManagerAllowed,handleSubscriptionDelete:this.handleSubscriptionDelete,selectedAppId:d,updateSubscriptionData:n,selectedKeyType:o,app:e,index:a,applicationOwner:E,hashEnabled:f})))))))())):s.a.createElement(k.a,{elevation:0,className:e.paper},s.a.createElement(u.a,{type:"info",className:e.dialogContainer},s.a.createElement(c.a,{component:"p","data-testid":"itest-no-tier-dialog"},s.a.createElement(C.a,{id:"Apis.Details.Creadentials.credetials.no.tiers",defaultMessage:"No tiers are available for the API."}))))))))}}W.propTypes={classes:i.a.shape({contentWrapper:i.a.string,titleSub:i.a.string,tableMain:i.a.string,th:i.a.string,paper:i.a.string,descWrapper:i.a.string,generateCredentialWrapper:i.a.string,credentialBoxWrapper:i.a.string,credentialBox:i.a.string,buttonElm:i.a.string,dialogContainer:i.a.string}).isRequired,history:i.a.shape({}).isRequired,intl:i.a.shape({}).isRequired},W.contextType=I.a;a.default=Object(v.c)(Object(o.a)(e=>({contentWrapper:{maxWidth:e.custom.contentAreaWidth,paddingLeft:e.spacing(3),paddingTop:e.spacing(3)},titleSub:{marginLeft:e.spacing(3),paddingTop:e.spacing(2),paddingBottom:e.spacing(2),color:e.palette.getContrastText(e.palette.background.default)},generateCredentialWrapper:{marginLeft:0,paddingTop:e.spacing(2),paddingBottom:e.spacing(2),"& span, & h5, & label, & td, & li, & div":{color:e.palette.getContrastText(e.palette.background.paper)}},tableMain:{"& > table":{width:"100%",borderCollapse:"collapse",marginTop:e.spacing(3),marginLeft:e.spacing(2),marginRight:e.spacing(1)},"& table > tr td":{paddingLeft:e.spacing(1)},"&  table > tr:nth-child(even)":{backgroundColor:e.custom.listView.tableBodyEvenBackgrund,"& td, & a, & .material-icons":{color:e.palette.getContrastText(e.custom.listView.tableBodyEvenBackgrund)}},"&  table > tr:nth-child(odd)":{backgroundColor:e.custom.listView.tableBodyOddBackgrund,"& td, & a, & .material-icons":{color:e.palette.getContrastText(e.custom.listView.tableBodyOddBackgrund)}},"&  table > tr > th":{backgroundColor:e.custom.listView.tableHeadBackground,color:e.palette.getContrastText(e.custom.listView.tableHeadBackground),paddingLeft:e.spacing(1),borderBottom:"solid 1px "+e.palette.grey.A200,borderTop:"solid 1px "+e.palette.grey.A200,textAlign:"left",fontSize:"11px",paddingTop:e.spacing(1),paddingBottom:e.spacing(1)},"& table > tr > th:last-child":{textAlign:"right"}},expansion:{background:"transparent",boxShadow:"none"},summary:{alignItems:"center"},subscribeRoot:{paddingLeft:e.spacing(2)},activeLink:{background:e.palette.grey.A100},appBar:{background:e.palette.background.paper,color:e.palette.getContrastText(e.palette.background.paper)},toolbar:{marginLeft:e.spacing(2)},subscribeTitle:{flex:1},paper:{marginLeft:e.spacing(3),padding:e.spacing(2)},descWrapper:{marginBottom:e.spacing(2),color:e.palette.getContrastText(e.palette.background.paper)},credentialBoxWrapper:{paddingLeft:e.spacing(2)},credentialBox:{padding:e.spacing(1),border:"solid 1px #ccc",borderRadius:5,marginBottom:e.spacing(2),marginTop:e.spacing(2)},addLinkWrapper:{marginLeft:e.spacing(2)},subsListTitle:{color:e.palette.getContrastText(e.palette.background.paper)},subsListDesc:{color:e.palette.getContrastText(e.palette.background.paper)},buttonElm:{"& span":{color:e.palette.getContrastText(e.palette.primary.main)}},launchIcon:{paddingLeft:e.spacing(1)},originalDevPortalLink:{marginTop:e.spacing(2)}}),{withTheme:!0})(W))}}]);
//# sourceMappingURL=APICredentials.adc4c21efd10886734c0.bundle.js.map