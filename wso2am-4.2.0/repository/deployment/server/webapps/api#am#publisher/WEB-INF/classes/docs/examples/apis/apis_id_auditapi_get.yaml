- id: auditApiGet
  request:
    method: GET
    url: https://localhost:9443/api/am/publisher/v1/apis/a8f0fb89-edf9-484c-b937-036b088f287d/auditapi
    headers: |
      Authorization: Bearer ae4eae22-3f65-387b-a171-d37eaa366fa8
  response:
    status:
      code: 200
      msg: OK
    headers: |
      Content-Type: application/json
    body:
      {
        "report":
          {
            "index":[
              "",
              "/components/schemas/Error",
              "/components/schemas/Error/properties/code",
              "/components/schemas/Error/properties/message",
              "/components/schemas/Pet",
              "/components/schemas/Pet/properties/id",
              "/components/schemas/Pet/properties/name",
              "/components/schemas/Pet/properties/tag",
              "/components/schemas/Pets",
              "/components/schemas/Pets/items",
              "/paths/~1pets/get",
              "/paths/~1pets/get/parameters/0",
              "/paths/~1pets/get/parameters/0/schema",
              "/paths/~1pets/get/parameters/1",
              "/paths/~1pets/get/parameters/1/schema",
              "/paths/~1pets/get/responses/200/content/application~1json/schema",
              "/paths/~1pets/get/responses/200/headers/x-next/schema",
              "/paths/~1pets/get/responses/default/content/application~1json/schema",
              "/paths/~1pets/get/security/0/default",
              "/paths/~1pets/post",
              "/paths/~1pets/post/responses/201",
              "/paths/~1pets/post/responses/default/content/application~1json/schema",
              "/paths/~1pets/post/security/0/default",
              "/paths/~1pets~1{petId}/get",
              "/paths/~1pets~1{petId}/get/parameters/0/schema",
              "/paths/~1pets~1{petId}/get/responses/200/content/application~1json/schema",
              "/paths/~1pets~1{petId}/get/responses/default/content/application~1json/schema",
              "/paths/~1pets~1{petId}/get/security/0/default"
            ],
            "assessmentVersion":"3.0.0",
            "oasVersion":"3.0.0",
            "apiVersion":"1.0.0",
            "fileId":"fd21f9f7-3674-49cf-8a83-dca401f635de",
            "apiId":"",
            "openapiState":"semanticInvalid",
            "score":28.0172,
            "valid":false,
            "criticality":4,
            "issueCounter":27,
            "semanticErrors":{
              "issues":{
                "v3.semantic.parameter.namein.multiple":{
                  "description":"Parameters defined having the same name + in combination",
                  "issues":[
                  {
                    "specificDescription":"Parameters in 'operation', /paths/~1pets/get/parameters/0', and '/paths/~1pets/get/parameters/1' have the same name + in combination",
                    "pointer":11
                  },
                  {
                    "specificDescription":"Parameters in 'operation', /paths/~1pets/get/parameters/0', and '/paths/~1pets/get/parameters/1' have the same name + in combination",
                    "pointer":13
                  }
                  ],
                  "totalIssues":2,
                  "tooManyError":false
                }
              }
            },
            "minimalReport":true,
            "maxEntriesPerIssue":30,
            "maxImpactedPerEntry":30,
            "security":{
              "issueCounter":4,
              "score":15,
              "criticality":3,
              "issues":{
                "v3.global.http.clear":{
                  "description":"API accepts HTTP requests in the clear",
                  "issues":[
                  {
                    "sensitivity":2,
                    "score":-7.5,
                    "pointer":0,
                    "tooManyImpacted":false,
                    "pointersAffected":[
                      10,
                      19,
                      23
                    ]
                  }
                  ],
                  "issueCounter":1,
                  "score":-7.5,
                  "criticality":3,
                  "tooManyError":false
                },
                "v3.operation.securityRequirement.weak":{
                  "description":"Access tokens transported as cleartext",
                  "issues":[
                  {
                    "specificDescription":"The operation 'get' accepts access tokens sent as cleartext",
                    "sensitivity":2,
                    "score":-2.5,
                    "pointer":18,
                    "tooManyImpacted":false
                  },
                  {
                    "specificDescription":"The operation 'post' accepts access tokens sent as cleartext",
                    "sensitivity":2,
                    "score":-2.5,
                    "pointer":22,
                    "tooManyImpacted":false
                  },
                  {
                    "specificDescription":"The operation 'get' accepts access tokens sent as cleartext",
                    "sensitivity":2,
                    "score":-2.5,
                    "pointer":27,
                    "tooManyImpacted":false
                  }
                  ],
                  "issueCounter":3,
                  "score":-7.5,
                  "criticality":3,
                  "tooManyError":false
                }
              }
            },
            "data":{
              "issueCounter":22,
              "score":13.017199999999999,
              "criticality":4,
              "issues":{
                "v3.response.schema.undefined":{
                  "description":"Response that should contain a body has no schema defined",
                  "issues":[
                  {
                    "sensitivity":2,
                    "score":-8.166666666666666,
                    "pointer":20,
                    "tooManyImpacted":false
                  }
                  ],
                  "issueCounter":1,
                  "score":-8.166666666666666,
                  "criticality":1,
                  "tooManyError":false
                },
                "v3.schema.array.maxItems":{
                  "description":"Array schema has no maximum number of the items defined",
                  "issues":[
                  {
                    "sensitivity":2,
                    "score":-0.7839999999999999,
                    "pointer":8,
                    "tooManyImpacted":false,
                    "pointersAffected":[
                      8,
                      15
                    ]
                  }
                  ],
                  "issueCounter":1,
                  "score":-0.7839999999999999,
                  "criticality":4,
                  "tooManyError":false
                },
                "v3.schema.numerical.max":{
                  "description":"Numeric schema has no maximum defined",
                  "issues":[
                  {
                    "specificDescription":"Numeric schema of type 'integer' has no maximum defined",
                    "sensitivity":2,
                    "score":-3.733333333333334,
                    "pointer":12,
                    "tooManyImpacted":false
                  },
                  {
                    "specificDescription":"Numeric schema of type 'integer' has no maximum defined",
                    "sensitivity":2,
                    "score":-3.733333333333334,
                    "pointer":14,
                    "tooManyImpacted":false
                  },
                  {
                    "specificDescription":"Numeric schema of type 'integer' has no maximum defined",
                    "sensitivity":2,
                    "score":-0.98,
                    "pointer":2,
                    "tooManyImpacted":false,
                    "pointersAffected":[
                      1,
                      17,
                      21,
                      26
                    ]
                  },
                  {
                    "specificDescription":"Numeric schema of type 'integer' has no maximum defined",
                    "sensitivity":2,
                    "score":-0.3397333333333333,
                    "pointer":5,
                    "tooManyImpacted":false,
                    "pointersAffected":[
                      4,
                      8,
                      9,
                      15,
                      25
                    ]
                  }
                  ],
                  "issueCounter":4,
                  "score":-8.7864,
                  "criticality":3,
                  "tooManyError":false
                },
                "v3.schema.numerical.min":{
                  "description":"Numeric schema has no minimum defined",
                  "issues":[
                  {
                    "specificDescription":"Numeric schema of type 'integer' has no minimum defined",
                    "sensitivity":2,
                    "score":-3.733333333333334,
                    "pointer":12,
                    "tooManyImpacted":false
                  },
                  {
                    "specificDescription":"Numeric schema of type 'integer' has no minimum defined",
                    "sensitivity":2,
                    "score":-3.733333333333334,
                    "pointer":14,
                    "tooManyImpacted":false
                  },
                  {
                    "specificDescription":"Numeric schema of type 'integer' has no minimum defined",
                    "sensitivity":2,
                    "score":-0.98,
                    "pointer":2,
                    "tooManyImpacted":false,
                    "pointersAffected":[
                      1,
                      17,
                      21,
                      26
                    ]
                  },
                  {
                    "specificDescription":"Numeric schema of type 'integer' has no minimum defined",
                    "sensitivity":2,
                    "score":-0.3397333333333333,
                    "pointer":5,
                    "tooManyImpacted":false,
                    "pointersAffected":[
                      4,
                      8,
                      9,
                      15,
                      25
                    ]
                  }
                  ],
                  "issueCounter":4,
                  "score":-8.7864,
                  "criticality":3,
                  "tooManyError":false
                },
                "v3.schema.object.additionalProperties.true":{
                  "description":"Schema allows additional properties",
                  "issues":[
                  {
                    "sensitivity":2,
                    "score":-4.8999999999999995,
                    "pointer":1,
                    "tooManyImpacted":false,
                    "pointersAffected":[
                      1,
                      17,
                      21,
                      26
                    ]
                  },
                  {
                    "sensitivity":2,
                    "score":-2.0906666666666665,
                    "pointer":4,
                    "tooManyImpacted":false,
                    "pointersAffected":[
                      4,
                      8,
                      9,
                      15,
                      25
                    ]
                  }
                  ],
                  "issueCounter":2,
                  "score":-6.990666666666666,
                  "criticality":3,
                  "tooManyError":false
                },
                "v3.schema.string.maxLength":{
                  "description":"String schema has no maximum length defined",
                  "issues":[
                  {
                    "sensitivity":2,
                    "score":-7.466666666666668,
                    "pointer":24,
                    "tooManyImpacted":false
                  },
                  {
                    "sensitivity":2,
                    "score":-0.98,
                    "pointer":3,
                    "tooManyImpacted":false,
                    "pointersAffected":[
                      1,
                      17,
                      21,
                      26
                    ]
                  },
                  {
                    "sensitivity":2,
                    "score":-0.3397333333333333,
                    "pointer":6,
                    "tooManyImpacted":false,
                    "pointersAffected":[
                      4,
                      8,
                      9,
                      15,
                      25
                    ]
                  },
                  {
                    "sensitivity":2,
                    "score":-0.3397333333333333,
                    "pointer":7,
                    "tooManyImpacted":false,
                    "pointersAffected":[
                      4,
                      8,
                      9,
                      15,
                      25
                    ]
                  },
                  {
                    "sensitivity":2,
                    "score":-0.26133333333333336,
                    "pointer":16,
                    "tooManyImpacted":false
                  }
                  ],
                  "issueCounter":5,
                  "score":-9.387466666666668,
                  "criticality":3,
                  "tooManyError":false
                },
                "v3.schema.string.pattern":{
                  "description":"String schema has no pattern defined",
                  "issues":[
                  {
                    "sensitivity":2,
                    "score":-11.2,
                    "pointer":24,
                    "tooManyImpacted":false
                  },
                  {
                    "sensitivity":2,
                    "score":-1.4699999999999998,
                    "pointer":3,
                    "tooManyImpacted":false,
                    "pointersAffected":[
                      1,
                      17,
                      21,
                      26
                    ]
                  },
                  {
                    "sensitivity":2,
                    "score":-0.5095999999999998,
                    "pointer":6,
                    "tooManyImpacted":false,
                    "pointersAffected":[
                      4,
                      8,
                      9,
                      15,
                      25
                    ]
                  },
                  {
                    "sensitivity":2,
                    "score":-0.5095999999999998,
                    "pointer":7,
                    "tooManyImpacted":false,
                    "pointersAffected":[
                      4,
                      8,
                      9,
                      15,
                      25
                    ]
                  },
                  {
                    "sensitivity":2,
                    "score":-0.39199999999999996,
                    "pointer":16,
                    "tooManyImpacted":false
                  }
                  ],
                  "issueCounter":5,
                  "score":-14.081199999999999,
                  "criticality":3,
                  "tooManyError":false
                }
              }
            }
          }
      }
